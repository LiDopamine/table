(()=>{var t={402:t=>{(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{Area:()=>L,Canvas:()=>c,Range:()=>y,Viewport:()=>q,default:()=>Y,eachRanges:()=>p,expr2xy:()=>l,findRanges:()=>w,stringAt:()=>i,xy2expr:()=>u});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function o(t){return n.charAt(t%n.length)}function i(t){for(var e=[];t>=0;)e.push(o(t)),t=parseInt(t/n.length+"",10)-1;return e.reverse().join("")}function a(t){for(var e=0,r=0;r<t.length;r++)e=26*e+t.charCodeAt(r)-64;return e-1}function l(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n).toUpperCase();return[a(e),parseInt(r,10)-1]}function u(t,e){return"".concat(i(t)).concat(e+1)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var c=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e;var n=e.getContext("2d");if(!n)throw new Error("getContext(2d) is null");this._ctx=n,this._scale=r,this._target=e}var e,r;return e=t,(r=[{key:"size",value:function(t,e){var r=this._target,n=this._scale;r.style.width="".concat(t,"px"),r.style.height="".concat(e,"px");var o=window.devicePixelRatio;return r.width=Math.floor(t*o),r.height=Math.floor(e*o),this._ctx.scale(o*n,o*n),this}},{key:"prop",value:function(t,e){var r=this;return e?(this._ctx[t]=e,this):"string"==typeof t?this._ctx[t]:(Object.entries(t).forEach((function(t){var e,n=function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(e)||function(t,e){if(t){if("string"==typeof t)return s(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],i=n[1];null!=i&&(r._ctx[o]=i)})),this)}},{key:"measureTextWidth",value:function(t){return this.measureText(t).width}},{key:"line",value:function(t,e,r,n){return this.moveTo(t,e).lineTo(r,n).stroke(),this}},{key:"clearRect",value:function(t,e,r,n){return this._ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this._ctx.fillRect(t,e,r,n),this}},{key:"strokeRect",value:function(t,e,r,n){return this._ctx.strokeRect(t,e,r,n),this}},{key:"fillText",value:function(t,e,r,n){return this._ctx.fillText(t,e,r,n),this}},{key:"strokeText",value:function(t,e,r,n){return this._ctx.strokeText(t,e,r,n),this}},{key:"measureText",value:function(t){return this._ctx.measureText(t)}},{key:"getLineDash",value:function(){return this._ctx.getLineDash()}},{key:"setLineDash",value:function(t){return this._ctx.setLineDash(t),this}},{key:"createLinearGradient",value:function(t,e,r,n){return this._ctx.createLinearGradient(t,e,r,n)}},{key:"createRadialGradient",value:function(t,e,r,n,o,i){return this._ctx.createRadialGradient(t,e,r,n,o,i)}},{key:"createPattern",value:function(t,e){return this._ctx.createPattern(t,e)}},{key:"beginPath",value:function(){return this._ctx.beginPath(),this}},{key:"closePath",value:function(){return this._ctx.closePath(),this}},{key:"moveTo",value:function(t,e){return this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this._ctx.lineTo(t,e),this}},{key:"bezierCurveTo",value:function(t,e,r,n,o,i){return this._ctx.bezierCurveTo(t,e,r,n,o,i),this}},{key:"quadraticCurveTo",value:function(t,e,r,n){return this._ctx.quadraticCurveTo(t,e,r,n),this}},{key:"arc",value:function(t,e,r,n,o,i){return this._ctx.arc(t,e,r,n,o,i),this}},{key:"arcTo",value:function(t,e,r,n,o){return this._ctx.arcTo(t,e,r,n,o),this}},{key:"ellipse",value:function(t,e,r,n,o,i,a,l){return this._ctx.ellipse(t,e,r,n,o,i,a,l),this}},{key:"rect",value:function(t,e,r,n){return this._ctx.rect(t,e,r,n),this}},{key:"roundRect",value:function(t,e,r,n,o){return this.beginPath().moveTo(t+o,e).arcTo(t+r,e,t+r,e+n,o).arcTo(t+r,e+n,t,e+n,o).arcTo(t,e+n,t,e,o).arcTo(t,e,t+r,e,o).closePath(),this}},{key:"fill",value:function(t){return this._ctx.fill(t),this}},{key:"stroke",value:function(){return this._ctx.stroke(),this}},{key:"clip",value:function(t){return this._ctx.clip(t),this}},{key:"isPointInPath",value:function(t,e,r){return this._ctx.isPointInPath(t,e,r)}},{key:"isPointInStroke",value:function(t,e){return this._ctx.isPointInStroke(t,e)}},{key:"getTransform",value:function(){return this._ctx.getTransform()}},{key:"rotate",value:function(t){return this._ctx.rotate(t),this}},{key:"scale",value:function(t,e){return this._ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this._ctx.translate(t,e),this}},{key:"setTransform",value:function(t,e,r,n,o,i){return this._ctx.setTransform(t,e,r,n,o,i),this}},{key:"drawImage",value:function(t,e,r){return this._ctx.drawImage(t,e,r),this}},{key:"createImageData",value:function(t,e){return this._ctx.createImageData(t,e)}},{key:"getImageData",value:function(t,e,r,n){return this._ctx.getImageData(t,e,r,n)}},{key:"putImageData",value:function(t,e,r){return this._ctx.putImageData(t,e,r),this}},{key:"save",value:function(){return this._ctx.save(),this}},{key:"restore",value:function(){return this._ctx.restore(),this}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var y=function(){function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startRow=e,this.startCol=r,this.endRow=n,this.endCol=o}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n,o){if(void 0!==n&&void 0!==o){var i=e,a=r,l=n,u=o;return e>n&&(i=n,l=e),r>o&&(a=o,u=r),new t(i,a,l,u)}return new t(e,r,e,r)}},{key:"with",value:function(t){var e=t.split(":"),r=h(l(e[0]),2),n=r[0],o=r[1];if(1===e.length)return this.create(o,n);var i=h(l(e[1]),2),a=i[0],u=i[1];return this.create(o,n,u,a)}}],(r=[{key:"start",get:function(){return[this.startRow,this.startCol]}},{key:"end",get:function(){return[this.endRow,this.endCol]}},{key:"rows",get:function(){return this.endRow-this.startRow}},{key:"cols",get:function(){return this.endCol-this.startCol}},{key:"multiple",get:function(){return this.cols>0||this.rows>0}},{key:"containsRow",value:function(t){return this.startRow<=t&&t<=this.endRow}},{key:"containsCol",value:function(t){return this.startCol<=t&&t<=this.endCol}},{key:"contains",value:function(t,e){return this.containsRow(t)&&this.containsCol(e)}},{key:"within",value:function(t){return this.startRow>=t.startRow&&this.startCol>=t.startCol&&this.endRow<=t.endRow&&this.endCol<=t.endCol}},{key:"intersectsRow",value:function(t,e){return this.startRow<=e&&t<=this.endRow}},{key:"intersectsCol",value:function(t,e){return this.startCol<=e&&t<=this.endCol}},{key:"intersects",value:function(t){var e=t.startRow,r=t.startCol,n=t.endRow,o=t.endCol;return this.intersectsCol(r,o)&&this.intersectsRow(e,n)}},{key:"intersection",value:function(e){return new t(e.startRow<this.startRow?this.startRow:e.startRow,e.startCol<this.startCol?this.startCol:e.startCol,e.endRow>this.endRow?this.endRow:e.endRow,e.endCol>this.endCol?this.endCol:e.endCol)}},{key:"union",value:function(e){return new t(e.startRow<this.startRow?e.startRow:this.startRow,e.startCol<this.startCol?e.startCol:this.startCol,e.endRow>this.endRow?e.endRow:this.endRow,e.endCol>this.endCol?e.endCol:this.endCol)}},{key:"difference",value:function(e){if(!this.intersects(e))return[];var r=this.startRow,n=this.startCol,o=this.endRow,i=this.endCol,a=this.intersection(e);return[new t(r,n,a.startRow-1,i),new t(a.endRow+1,n,o,i),new t(a.startRow,n,a.endRow,a.startCol-1),new t(a.startRow,a.endCol+1,a.endRow,i)].filter((function(t){return t.rows>=0&&t.cols>=0}))}},{key:"touches",value:function(t){return t.startRow===this.startRow&&t.endRow===this.endRow&&(t.endCol+1===this.startCol||this.endCol+1===t.startCol)||t.startCol===this.startCol&&t.endCol===this.endCol&&(t.endRow+1===this.startRow||this.endRow+1===this.startCol)}},{key:"eachRow",value:function(t,e){var r=this.endRow;e&&r>e&&(r=e);for(var n=this.startRow;n<=r;n+=1)t(n);return this}},{key:"eachCol",value:function(t,e){var r=this.endCol;e&&r>e&&(r=e);for(var n=this.startCol;n<=r;n+=1)t(n);return this}},{key:"each",value:function(t){var e=this;return this.eachRow((function(r){e.eachCol((function(e){return t(r,e)}))})),this}},{key:"clone",value:function(){return new t(this.startRow,this.startCol,this.endRow,this.endCol)}},{key:"toString",value:function(){var t=u(this.startCol,this.startRow);return this.multiple&&(t+=":".concat(u(this.endCol,this.endRow))),t}},{key:"equals",value:function(t){return this.startRow===t.startRow&&this.startCol===t.startCol&&this.endRow===t.endRow&&this.endCol===t.endCol}}])&&v(e.prototype,r),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t,e){t&&t.length>0&&t.forEach((function(t){e(y.with(t))}))}function w(t,e){if(t&&t.length>0){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=f(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(n.s();!(r=n.n()).done;){var o=r.value,i=y.with(o);if(e(i))return i}}catch(t){n.e(t)}finally{n.f()}}return null}function g(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){if(t){if("string"==typeof t)return _(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function m(t,e,r,n){if(t&&e){var o="";return r&&(o+="italic "),n&&(o+="bold "),"".concat(o," ").concat(e,"pt ").concat(t)}}function k(t,e,r){var n,o,i,a,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(r)?n=o=i=a=r:(n=r.top,o=r.right,i=r.bottom,a=r.left),t.save().beginPath().translate(e.x,e.y);var u=function(t,r){return[[0-r,0,e.width+r,0],[e.width,0,e.width,e.height],[0-r,e.height,e.width+r,e.height],[0,0,0,e.height]][t]};[n,o,i,a].forEach((function(e,r){if(e){var n,o=[],i=1;"thick"===e[0]?i=3:"medium"===e[0]?i=2:"dotted"===e[0]?o=[1,1]:"dashed"===e[0]&&(o=[2,2]);var a=0;l&&(a=i/2),(n=t.prop({strokeStyle:e[1],lineWidth:i}).setLineDash(o)).line.apply(n,g(u(r,a)))}})),t.restore()}function R(t,e,r,n,o,i){var a="";e&&("string"==typeof e||"number"==typeof e?a=i("".concat(e)):(e.type,a=i((e.value||"")+"",e.format)));var l,u=n.fontSize,s=n.fontFamily,c=n.bold,h=n.italic,f=n.color,d=n.bgcolor,v=n.align,y=n.valign,p=n.underline,w=n.strikethrough,_=n.rotate,k=n.textwrap,R=n.padding;if(t.save().beginPath().translate(r.x,r.y),t.rect(0,0,r.width,r.height).clip(),d&&t.prop("fillStyle",d).fill(),_&&_>0&&t.rotate(_*(Math.PI/180)),void 0!==o){if(t.save(),!o(t,r,e,a))return void t.restore();t.restore()}if(a&&!/^\s*$/.test(a)){t.save().beginPath().prop({textAlign:v,textBaseline:y,font:m(s,u,h,c),fillStyle:f});var x=function(t){if(Array.isArray(t))return t}(l=R||[5,5])||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(l)||b(l,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),C=x[0],A=x[1],S=function(t,e,r){switch(t){case"left":return r;case"center":return e/2;case"right":return e-r;default:return 0}}(v,r.width,C),j=a.split("\n"),O=r.width-2*C,P=[];j.forEach((function(e){var r=t.measureTextWidth(e);if(k&&r>O){for(var n={w:0,len:0,start:0},o=0;o<e.length;o+=1)n.w>O&&(P.push(e.substr(n.start,n.len)),n={w:0,len:0,start:o}),n.len+=1,n.w+=t.measureTextWidth(e[o])+1;n.len>0&&P.push(e.substr(n.start,n.len))}else P.push(e)}));var I=u/.75,T=(P.length-1)*I,E=[];p&&E.push("underline"),w&&E.push("strikethrough");var H=function(t,e,r,n,o){switch(t){case"top":return o;case"middle":var i=e/2-r/2,a=n/2+o;return i<a?a:i;case"bottom":return e-o-r;default:return 0}}(y,r.height,T,I,A);P.forEach((function(e){var r=t.measureTextWidth(e);t.fillText(e,S,H),E.forEach((function(e){t.line.apply(t,g(function(t,e,r,n,o,i,a){var l=0;"underline"===t?"top"===r?l=-a:"middle"===r&&(l=-a/2):"strikethrough"===t&&("top"===r?l=-a/2:"bottom"===r&&(l=a/2));var u=0;return"center"===e?u=i/2:"right"===e&&(u=i),[n-u,o-l,n-u+i,o-l]}(e,v,y,S,H,r,u)))})),H+=I})),t.restore()}t.restore()}function x(t){return function(t){if(Array.isArray(t))return A(t)}(t)||S(t)||C(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){if(t){if("string"==typeof t)return A(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(t,e):void 0}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function S(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function j(t,e,r){var n,o=function(t){if(Array.isArray(t))return t}(n=e)||S(n)||C(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],a=o[1],l=o.slice(2),u=[],s=y.with(i),c=r.filter((function(t){return t.intersects(s)}));if(s.intersects(t.range)||c.length>0)if(c.length<=0)u.push([s,t.rect(s),a]);else{var h,f=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=C(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(c);try{var d=function(){var e=h.value;if(!s.within(e)){if("outside"===a||"left"===a||"top"===a||"right"===a||"bottom"===a)return u.push([s,t.rect(s),a]),"break";var r=c.filter((function(t){return!t.equals(e)}));if(s.difference(e).forEach((function(n){if(n.intersects(t.range)){var o=t.rect(n);u.push.apply(u,x(j(t,[n.toString(),a].concat(x(l)),r))),"inside"!==a&&"horizontal"!==a||(n.startRow<e.startRow&&n.endRow<e.startRow?u.push([n,o,"bottom"]):n.startRow>e.startRow&&n.endRow>e.startRow&&u.push([n,o,"top"])),"inside"!==a&&"vertical"!==a||(n.startCol<e.startCol&&n.endCol<e.startCol&&u.push([n,o,"right"]),n.startCol>e.startCol&&n.endCol>e.startCol&&u.push([n,o,"left"]))}})),"all"===a){var n=t.rect(e);s.startRow===e.startRow&&u.push([e,n,"top"]),s.endRow===e.endRow&&u.push([e,n,"bottom"]),s.startCol===e.startCol&&u.push([e,n,"left"]),s.endCol===e.endCol&&u.push([e,n,"right"])}return"break"}s.startRow===e.startRow&&s.startCol===e.startCol&&"inside"!==a&&"horizontal"!==a&&"vertical"!==a&&u.push([e,t.rect(e),"all"===a?"outside":a])};for(f.s();!(h=f.n()).done&&"break"!==d(););}catch(t){f.e(t)}finally{f.f()}}return u}function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function P(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||T(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){if(t){if("string"==typeof t)return E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function H(t,e,r){var n=e.width,o=e.color;n>0&&(t.save().beginPath().prop({lineWidth:n-.5,strokeStyle:o}),r(),t.restore())}function M(t,e,r){var n=r.x,o=r.y,i=r.width,a=r.height;H(t,e,(function(){t.translate(n,o).line(i,0,i,a).line(0,a,i,a)}))}function z(t,e,r,n){if(r){var o,i,a,l,u,s,c=function(t){return t},h=n._headerStyle,f=n._headerGridline,d=n._styles,v=n._rowHeader,y=n._colHeader;if("row-header"===t){if(v.width<=0)return;o=v.cell,a=v.merges,i=v.cellRenderer}else if("col-header"===t){if(y.height<=0)return;o=y.cell,a=y.merges,i=y.cellRenderer}else o=n._cell,i=n._cellRenderer,c=n._formatter,h=n._style,f=n._gridline,d=n._styles,a=n._merges,l=n._borders,u=n._row,s=n._col;e.save().translate(r.x,r.y).prop("fillStyle",n._bgcolor).rect(0,0,r.width,r.height).fill().clip();var w=function(t,e,r){var n=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){P(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},h);if(u){var o=u(t);o&&void 0!==o.style&&Object.assign(n,d[o.style])}if(s){var i=s(e);i&&void 0!==i.style&&Object.assign(n,d[i.style])}return r instanceof Object&&void 0!==r.style&&Object.assign(n,d[r.style]),n},g=[],b=[],_=new Set;a&&p(a,(function(t){if(t.intersects(r.range)){var e=o(t.startRow,t.startCol),n=w(t.startRow,t.startCol,e),i=r.rect(t);b.push([e,i,n]),g.push(t),t.each((function(t,e){_.add("".concat(t,"_").concat(e))}))}}));var m=function(r,n,o){"body"===t?(M(e,f,n),R(e,r,n,o,i,c)):(R(e,r,n,o,i,c),M(e,f,n))};r.each((function(t,e,r){if(!_.has("".concat(t,"_").concat(e))){var n=o(t,e);m(n,r,w(t,e,n))}})),b.forEach((function(t){return m.apply(void 0,function(t){if(Array.isArray(t))return E(t)}(e=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var e})),function(t,e,r,n){r&&r.length>0&&r.forEach((function(r){var o=I(r,4),i=o[2],a=o[3];j(e,r,n).forEach((function(r){var n=I(r,3),o=n[0],l=n[1],u=n[2];!function(t,e,r,n,o,i,a,l){var u=[i,a];"outside"===o||"all"===o?k(t,n,u,!0):"left"===o?k(t,n,{left:u},l):"top"===o?k(t,n,{top:u},l):"right"===o?k(t,n,{right:u},l):"bottom"===o&&k(t,n,{bottom:u},l),"all"!==o&&"inside"!==o&&"horizontal"!==o&&"vertical"!==o||("horizontal"!==o&&r.eachCol((function(n){if(n<r.endCol){var o=r.clone();o.endCol=o.startCol=n,o.intersects(e.range)&&k(t,e.rect(o),{right:u},l)}})),"vertical"!==o&&r.eachRow((function(n){if(n<r.endRow){var o=r.clone();o.endRow=o.startRow=n,o.intersects(e.range)&&k(t,e.rect(o),{bottom:u},l)}})))}(t,e,o,l,u,i,a)}))}))}(e,r,l,g),e.restore()}}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function D(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var L=function(){function t(e,r,n,o,i){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),D(this,"width",0),D(this,"height",0),D(this,"rowMap",new Map),D(this,"colMap",new Map),D(this,"cellAtCache",null),this.range=e,this.x=r,this.y=n,this.rowHeight=o,this.colWidth=i,e.eachRow((function(t){var e=o(t);a.rowMap.set(t,{y:a.height,height:e}),a.height+=e})),e.eachCol((function(t){var e=i(t);a.colMap.set(t,{x:a.width,width:e}),a.width+=e}))}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n,o,i,a,l,u){return new t(new y(e,r,n,o),i,a,l,u)}}],(r=[{key:"containsx",value:function(t){return t>=this.x&&t<this.x+this.width}},{key:"containsy",value:function(t){return t>=this.y&&t<this.y+this.height}},{key:"contains",value:function(t,e){return this.containsx(t)&&this.containsy(e)}},{key:"eachRow",value:function(t){var e=this;this.range.eachRow((function(r){var n=e.rowMap.get(r)||{y:0,height:0},o=n.y,i=n.height;i>0&&t(r,o,i)}))}},{key:"eachCol",value:function(t){var e=this;this.range.eachCol((function(r){var n=e.colMap.get(r)||{x:0,width:0},o=n.x,i=n.width;i>0&&t(r,o,i)}))}},{key:"each",value:function(t){var e=this;this.eachRow((function(r,n,o){e.eachCol((function(e,i,a){t(r,e,{x:i,y:n,width:a,height:o})}))}))}},{key:"rectRow",value:function(t,e){var r,n=this.rowMap,o=this.range,i=0,a=0;t>=o.startRow&&(i=(null===(r=n.get(t))||void 0===r?void 0:r.y)||0);for(var l=t;l<=e;l+=1){var u=this.rowHeight(l);u>0&&(l<o.startRow&&(i-=u),a+=u)}return{x:0,y:i,width:this.width,height:a}}},{key:"rectCol",value:function(t,e){var r,n=this.colMap,o=this.range,i=0,a=0;t>=o.startCol&&(i=(null===(r=n.get(t))||void 0===r?void 0:r.x)||0);for(var l=t;l<=e;l+=1){var u=this.colWidth(l);u>0&&(l<o.startCol&&(i-=u),a+=u)}return{x:i,y:0,width:a,height:this.height}}},{key:"rect",value:function(t){var e=this.rectRow(t.startRow,t.endRow),r=e.y,n=e.height,o=this.rectCol(t.startCol,t.endCol);return{x:o.x,y:r,width:o.width,height:n}}},{key:"cellAt",value:function(t,e){var r=this.cellAtCache;if(null!=r&&t>r.x&&t<=r.x+r.width&&e>r.y&&e<=r.y+r.height)return r;for(var n=this.range,o={row:n.startRow,col:n.startCol,x:this.x,y:this.y,width:0,height:0};o.y<e;){var i=this.rowHeight(o.row++);o.y+=i,o.height=i}for(o.y-=o.height,o.row--;o.x<t;){var a=this.colWidth(o.col++);o.x+=a,o.width=a}return o.x-=o.width,o.col--,this.cellAtCache=o,o}}])&&W(e.prototype,r),n&&W(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach((function(e){B(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function B(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=K(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||K(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(t,e){if(t){if("string"==typeof t)return G(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(t,e):void 0}}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._render=e;for(var r=[e._rowHeader.width,e._colHeader.height],n=r[0],o=r[1],i=$(e._freeze,2),a=i[0],l=i[1],u=e._startRow,s=e._startCol,c=e._rows,h=e._cols,f=function(t){return e.rowHeightAt(t)},d=function(t){return e.colWidthAt(t)},v=L.create(u,s,l-1,a-1,n,o,f,d),y=l+e._scrollRows,p=a+e._scrollCols,w=v.height,g=y;w<e._height&&g<c;)w+=f(g),g+=1;for(var b=v.width,_=p;b<e._width&&_<h;)b+=d(_),_+=1;var m=L.create(y,p,g-1,_-1,n+v.width,o+v.height,f,d),k=L.create(u,p,l-1,_-1,n+v.width,o,f,d),R=L.create(y,s,g-1,a-1,n,o+v.height,f,d);this.areas=[k,v,R,m];var x=e._rowHeader,C=e._colHeader,A=function(){return C.height/C.rows},S=function(){return x.width/x.cols};this.headerAreas=[L.create(0,k.range.startCol,C.rows-1,k.range.endCol,m.x,0,A,d),L.create(0,v.range.startCol,C.rows-1,v.range.endCol,v.x,0,A,d),L.create(v.range.startRow,0,v.range.endRow,x.cols-1,0,v.y,f,S),L.create(R.range.startRow,0,R.range.endRow,x.cols-1,0,m.y,f,S)]}var e,r;return e=t,(r=[{key:"inAreas",value:function(t,e){var r,n=U(this.areas);try{for(n.s();!(r=n.n()).done;)if(r.value.range.contains(t,e))return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"cellAt",value:function(t,e){var r=this.areas[1],n=$(this.headerAreas,4),o=n[0],i=n[1],a=n[2],l=n[3];if(t<r.x&&e<r.y)return{placement:"all",row:0,col:0,x:0,y:0,width:r.x,height:r.y};if(t<r.x)return V({placement:"row-header"},(a.containsy(e)?a:l).cellAt(t,e));if(e<r.y)return V({placement:"col-header"},(i.containsx(t)?i:o).cellAt(t,e));var u,s=U(this.areas);try{for(s.s();!(u=s.n()).done;){var c=u.value;if(c.contains(t,e))return V({placement:"body"},c.cellAt(t,e))}}catch(t){s.e(t)}finally{s.f()}return null}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function X(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Y=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),X(this,"_bgcolor","#ffffff"),X(this,"_width",0),X(this,"_height",0),X(this,"_scale",1),X(this,"_rows",100),X(this,"_cols",26),X(this,"_rowHeight",22),X(this,"_colWidth",100),X(this,"_startRow",0),X(this,"_startCol",0),X(this,"_scrollRows",0),X(this,"_scrollCols",0),X(this,"_row",(function(){})),X(this,"_col",(function(){})),X(this,"_cell",(function(){})),X(this,"_cellRenderer",(function(){return!0})),X(this,"_formatter",(function(t){return t})),X(this,"_merges",[]),X(this,"_borders",[]),X(this,"_styles",[]),X(this,"_gridline",{width:1,color:"#e6e6e6"}),X(this,"_style",{align:"left",valign:"middle",textwrap:!1,underline:!1,strikethrough:!1,color:"#0a0a0a",bold:!1,italic:!1,rotate:0,fontSize:10,fontFamily:"Source Sans Pro"}),X(this,"_rowHeader",{width:60,cols:1,cell:function(t,e){return t+1}}),X(this,"_colHeader",{height:24,rows:1,cell:function(t,e){return i(e)}}),X(this,"_headerGridline",{width:1,color:"#e6e6e6"}),X(this,"_headerStyle",{bgcolor:"#f4f5f8cc",align:"center",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#585757",bold:!1,italic:!1,rotate:0,fontSize:10,fontFamily:"Source Sans Pro"}),X(this,"_freeze",[0,0]),X(this,"_freezeGridline",{width:2,color:"#d8d8d8"}),X(this,"_viewport",null);var o="string"==typeof e?document.querySelector(e):e;if(!o)throw new Error("target error");this._target=o,this._width=r,this._height=n}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n){return new t(e,r,n)}}],(r=[{key:"render",value:function(){return this._viewport=new q(this),function(t){var e=t._width,r=t._height,n=t._target,o=t._scale,i=t._viewport,a=t._freeze,l=t._rowHeader,u=t._colHeader;if(i){var s=new c(n,o);s.size(e,r);var h=I(i.areas,4),f=h[0],d=h[1],v=h[2],y=h[3],p=I(i.headerAreas,4),w=p[0],g=p[1],b=p[2],_=p[3];z("body",s,y,t),z("body",s,f,t),z("col-header",s,w,t),z("body",s,v,t),z("row-header",s,_,t),z("body",s,d,t),z("col-header",s,g,t),z("row-header",s,b,t);var m=I(a,2),k=m[0],R=m[1];(k>0||R>0)&&H(s,t._freezeGridline,(function(){k>0&&s.line(0,y.y,e,y.y),R>0&&s.line(y.x,0,y.x,r)}));var x=d.x,C=d.y;if(x>0&&C>0){var A=u.height,S=l.width,j=t._headerStyle.bgcolor;j&&s.save().prop({fillStyle:j}).rect(0,0,S,A).fill().restore(),H(s,t._headerGridline,(function(){s.line(0,A,S,A).line(S,0,S,A)}))}}}(this),this}},{key:"bgcolor",value:function(t){return this._bgcolor=t,this}},{key:"width",value:function(t){return this._width=t,this}},{key:"height",value:function(t){return this._height=t,this}},{key:"scale",value:function(t){return this._scale=t,this}},{key:"rows",value:function(t){return this._rows=t,this}},{key:"cols",value:function(t){return this._cols=t,this}},{key:"rowHeight",value:function(t){return this._rowHeight=t,this}},{key:"colWidth",value:function(t){return this._colWidth=t,this}},{key:"startRow",value:function(t){return this._startRow=t,this}},{key:"startCol",value:function(t){return this._startCol=t,this}},{key:"scrollRows",value:function(t){return this._scrollRows=t,this}},{key:"scrollCols",value:function(t){return this._scrollCols=t,this}},{key:"row",value:function(t){return this._row=t,this}},{key:"col",value:function(t){return this._col=t,this}},{key:"cell",value:function(t){return this._cell=t,this}},{key:"cellRenderer",value:function(t){return this._cellRenderer=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"merges",value:function(t){return this._merges=t,this}},{key:"styles",value:function(t){return this._styles=t,this}},{key:"borders",value:function(t){return this._borders=t,this}},{key:"gridline",value:function(t){return t&&Object.assign(this._gridline,t),this}},{key:"style",value:function(t){return t&&Object.assign(this._style,t),this}},{key:"rowHeader",value:function(t){return t&&Object.assign(this._rowHeader,t),this}},{key:"colHeader",value:function(t){return t&&Object.assign(this._colHeader,t),this}},{key:"headerGridline",value:function(t){return t&&Object.assign(this._headerGridline,t),this}},{key:"headerStyle",value:function(t){return t&&Object.assign(this._headerStyle,t),this}},{key:"freeze",value:function(t){return t&&(this._freeze=l(t)),this}},{key:"freezeGridline",value:function(t){return t&&Object.assign(this._freezeGridline,t),this}},{key:"rowHeightAt",value:function(t){var e=this._row;if(e){var r=e(t);if(r)return!0===r.hide?0:r.height}return this._rowHeight}},{key:"colWidthAt",value:function(t){var e=this._col;if(e){var r=e(t);if(r)return!0===r.hide?0:r.width}return this._colWidth}},{key:"viewport",get:function(){return this._viewport}}])&&N(e.prototype,r),n&&N(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();try{var Q;window&&((Q=window).wolf||(Q.wolf={}),window.wolf.table_renderer=Y.create)}catch(e){}t.exports=r})()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{default:()=>qt});var t="wolf-table";function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t){if(Array.isArray(t))return t}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){for(var t=document.createDocumentFragment(),e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){var r;r=e instanceof s?e._:"string"==typeof e?document.createTextNode(e):e,t.appendChild(r)})),t}var s=function(){function t(r,n){var i,l,u,s,c;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,l="_data",u=new Map,l in i?Object.defineProperty(i,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[l]=u,this._=r instanceof Node?r:document.createElement(r),n)if("string"==typeof n)this._.className=n;else if(Array.isArray(n))this._.className=n.join(" ");else for(var h=0,f=Object.entries(n);h<f.length;h++){var d=(s=f[h],c=2,a(s)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(s,c)||o(s,c)||e()),v=d[0];d[1]&&this._.classList.add(v)}}var r,n;return r=t,n=[{key:"element",value:function(){return this._}},{key:"data",value:function(t,e){return e?(this._data.set(t,e),this):this._data.get(t)}},{key:"on",value:function(t,r){var n,i=a(n=t.split("."))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||o(n)||e(),l=i[0],u=i.slice(1);return this._.addEventListener(l,(function(t){r(t);for(var e=0;e<u.length;e+=1)"stop"===u[e]&&t.stopPropagation(),"prevent"===u[e]&&t.preventDefault()})),this}},{key:"focus",value:function(){return this._.focus(),this}},{key:"value",value:function(t){return void 0!==t?(this._.value=t,this):this._.value}},{key:"textContent",value:function(t){return this._.textContent=t,this}},{key:"html",value:function(t){return this._.innerHTML=t,this}},{key:"attr",value:function(t,e){return e?(this._.setAttribute(t,e),this):this._.getAttribute(t)}},{key:"css",value:function(t,e){var r=this._.style;return e?(r.setProperty(t,e),this):"string"==typeof t?r.getPropertyValue(t):(Object.keys(t).forEach((function(e){var n=t[e];"number"==typeof n&&(n="".concat(n,"px")),r.setProperty(e,n)})),this)}},{key:"rect",value:function(){return this._.getBoundingClientRect()}},{key:"offset",value:function(){var t=this._;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}}},{key:"show",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.css("display",t?"block":"none"),this}},{key:"hide",value:function(){return this.css("display","none"),this}},{key:"scrollx",value:function(t){var e=this._;return void 0!==t?(e.scrollLeft=t,this):e.scrollLeft}},{key:"scrolly",value:function(t){var e=this._;return void 0!==t?(e.scrollTop=t,this):e.scrollTop}},{key:"after",value:function(){return this._.after(u.apply(void 0,arguments)),this}},{key:"before",value:function(){return this._.before(u.apply(void 0,arguments)),this}},{key:"append",value:function(){return this._.append(u.apply(void 0,arguments)),this}},{key:"remove",value:function(){for(var e=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];n.forEach((function(r){e._.removeChild(r instanceof t?r._:r)}))}},{key:"cloneNode",value:function(){return this._.cloneNode(!0)}},{key:"firstChild",get:function(){var e=this._.firstChild;return e?new t(e):null}}],n&&l(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function c(t,e){return new s(t,e)}var h=r(402),f=r.n(h);function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return v(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,"_",[]),p(this,"_indexes",new Map),p(this,"_formulas",[]),p(this,"_formulaParser",(function(t){return t})),p(this,"_formatter",(function(t){return t}))}var e,r;return e=t,(r=[{key:"formulaParser",value:function(t){return this._formulaParser=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"load",value:function(t){var e=t.cells;e&&(this._=e,this.resetIndexes())}},{key:"get",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t).get(e);return void 0!==n?this._[n]:null}return null}},{key:"remove",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t),o=n.get(e);void 0!==o&&(this._.splice(o,1),n.delete(e))}return this}},{key:"set",value:function(t,e,r){var n=this.get(t,e);if(null===n){if(null!=r){var o=this._.push([t,e,r])-1;this.updateIndex(t,e,o),this.addFormula(r,o)}}else{var i=n[2],a=b(i),l=b(r);""===l?(i instanceof Object&&Object.keys(i).length>1?delete i.value:this.remove(t,e),this.resetFormulas()):(i instanceof Object?Object.assign(i,r instanceof Object?r:{value:r}):n[2]=r,l!==a&&this.resetFormulas())}}},{key:"resetIndexes",value:function(){for(var t=this._,e=0;e<t.length;e+=1){var r=d(t[e],3),n=r[0],o=r[1],i=r[2];this.updateIndex(n,o,e),this.addFormula(i,e)}}},{key:"updateIndex",value:function(t,e,r){var n=this._indexes;n.has(t)||n.set(t,new Map),n.get(t).set(e,r)}},{key:"addFormula",value:function(t,e){t instanceof Object&&t.formula&&(t.value=this._formulaParser(t.formula),this._formulas.push(e))}},{key:"resetFormulas",value:function(){var t=this;this._formulas.forEach((function(e){var r=d(t._[e],3)[2];r instanceof Object&&(r.value=t._formulaParser(r.formula))}))}}])&&y(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return t instanceof Object?t.value:t}function b(t){var e=g(t);return"".concat(null!=e?e:"")}function _(t,e,r,n,o){var i=t.scroll,a="row"===n?0:1,l="row"===n?3:2,u=i[l],s=!1,c=i[a],f=0,d=t.freeze;if(d&&(f=(0,h.expr2xy)(d)["row"===n?1:0]),r>0)if("+"===e)for(var v="row"===n?t.rows.len:t.cols.len,y=c;y<v&&!(u>=r);y+=1)u+=o(f+y),t.scroll[a]=y+1,s=!0;else for(var p=c;p>0&&!(u<=r);p-=1)u-=o(f+p),t.scroll[a]=p-1,s=!0;else t.scroll[a]=0,u=0,s=!0;return i[l]=u,s}function m(t,e){var r=t.merges;if(r)for(var n=h.Range.with(e),o=0;o<r.length;o+=1)if(h.Range.with(r[o]).equals(n))return!0;return!1}function k(t,e){var r=h.Range.with(e);if(r.multiple){t.merges||(t.merges=[]);var n=t.merges;n.length<=0||n.forEach((function(t,e){h.Range.with(t).within(r)&&n.splice(e,1)})),n.push(e)}}function R(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1)if(r[n]===e)return void r.splice(n,1)}function x(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1){var o=h.Range.with(r[n]);o.intersects(e)&&(e=o.union(e))}return e}function C(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n}function A(t,e){var r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(var n=0;n<r.length;n+=1){var o=r[n],i=t[o],a=e[o];if(void 0===a)return!1;if("string"==typeof i||"number"==typeof i||"boolean"==typeof i){if(i!==a)return!1}else if(Array.isArray(i)){if(i.length!==a.length)return!1;for(var l=0;l<i.length;l+=1)if(!A(i[l],a[l]))return!1}else if("function"!=typeof i&&!Array.isArray(i)&&i instanceof Object&&!A(i,a))return!1}return!0}function S(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.styles[e];return r?Object.assign({},t.style,t.styles[e]||{}):n}function j(t){return function(t){if(Array.isArray(t))return I(t)}(t)||T(t)||P(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t){return function(t){if(Array.isArray(t))return t}(t)||T(t)||P(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){if(t){if("string"==typeof t)return I(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(t,e):void 0}}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function T(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function H(t,e){t.borders||(t.borders=[]);for(var r=h.Range.with(e[0]),n=t.borders,o=function(t){var o=O(n[t]),i=o[0],a=o.slice(1),l=h.Range.with(i);return l.intersects(r)?(l.within(r)||(n.push(e),l.difference(r).forEach((function(t){n.push([t.toString()].concat(j(a)))}))),n.splice(t,1),{v:void 0}):a.every((function(t,r){return t===e[r+1]}))&&l.touches(r)?(n[t][0]=l.union(r).toString(),{v:void 0}):void 0},i=0;i<n.length;i+=1){var a=o(i);if("object"===E(a))return a.v}n.push(e)}function M(t,e,r){var n=t.cols[e]||{width:t.colWidth};return r?t.cols[e]=Object.assign(n,r):n}function z(t,e,r){if(!r){var n=M(t,e);return n.hide?0:n.width}var o=t.cols;o[e]?o[e].width=r:o[e]={width:r}}function W(t,e,r){var n=t.cols;if(1===arguments.length){var o=n.len*t.colWidth;for(var i in n)if("len"!==i){var a=z(t,parseInt(i,10));a>0&&(o+=a,o-=t.colWidth)}return o}return C(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return z(t,e)}))}function D(t,e,r){var n=t.rows[e]||{height:t.rowHeight};return r?t.rows[e]=Object.assign(n,r):n}function L(t,e,r){if(!r){var n=D(t,e);return n.hide?0:n.height}var o=t.rows;o[e]?o[e].height=r:o[e]={height:r}}function F(t,e,r){var n=t.rows;if(1===arguments.length){var o=n.len*t.rowHeight;for(var i in n)if("len"!==i){var a=L(t,parseInt(i,10));a>0&&(o+=a,o-=t.rowHeight)}return o}return C(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return L(t,e)}))}function V(t,e){if(t){if("string"==typeof t)return B(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(t,e):void 0}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function K(t,e,r){return e&&$(t.prototype,e),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function G(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var q=function(){function e(r){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];U(this,e),G(this,"_rect",null),G(this,"_target",null),this._=c("div","".concat(t,"-").concat(r)),n&&this.show()}return K(e,[{key:"append",value:function(t){return this._.append(t),this}},{key:"rect",value:function(t){return this._rect=t,this._.css({left:t.x,top:t.y,width:t.width,height:t.height}),this}},{key:"target",value:function(t){return t.append(this._),this._target=t,this}},{key:"show",value:function(){return this._.show(),this}},{key:"clear",value:function(){var t=this._target,e=this._;t&&(t.remove(e),this._target=null)}}]),e}(),N=function(){function t(e,r){U(this,t),G(this,"_placement","body"),G(this,"_editable",!1),G(this,"_ranges",[]),G(this,"_rowHeaderRanges",[]),G(this,"_colHeaderRanges",[]),G(this,"_areas",[]),G(this,"_focus",[0,0]),G(this,"_focusRange",null),G(this,"_focusAreas",[]),G(this,"_copyRange",null),G(this,"_copyAreas",[]),this._editable=r,this._data=e}return K(t,[{key:"placement",value:function(t){return this._placement=t,this}},{key:"addRange",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._focus=[t,e];var n=x(this._data,h.Range.create(t,e));return r&&(this._ranges.length=0,this.clear()),this._ranges.push(n),this._focusRange=n,Y(this),this}},{key:"unionRange",value:function(t,e){var r=h.Range.create(t,e),n=this._focusRange;if(n){var o=n.union(r);this._ranges.splice(-1,1,x(this._data,o)),Y(this)}return this}},{key:"move",value:function(t,e){var r,n,o=this._focusRange;if(o){var i=o.startRow,a=o.startCol,l=o.endRow,u=o.endCol,s=this._data,c=s.rows,h=s.cols,f=(r=this._focus,n=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(r,n)||V(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=f[0],v=f[1];if(e){var y=function(t,e){for(;;){var r=D(s,t);if(!r||!r.hide)return t;t+=e}},p=function(t,e){for(;;){var r=M(s,t);if(!r||!r.hide)return t;t+=e}};"up"===t?d=y(i-e,-1):"down"===t?d=y(l+e,1):"left"===t?v=p(a-e,-1):"right"===t&&(v=p(u+e,1))}else"up"===t?d=0:"down"===t?d=c.len-1:"left"===t?v=0:"right"===t&&(v=h.len-1);d>=0&&d<=c.len-1&&v>=0&&v<=h.len-1&&this.addRange(d,v,!0)}}},{key:"addArea",value:function(t,e,r){var n=e.x,o=e.y,i=e.width,a=e.height;if(this._areas.push(new q("selector-area",!0).rect(e).target(r)),t===this._ranges.length-1){var l=new q("selector",!0).rect({x:n-1,y:o-1,width:i-2,height:a-2}).target(r);"body"===this._placement&&l.append(c("div","corner")),this._areas.push(l)}return this}},{key:"addRowHeaderArea",value:function(t,e){return this._areas.push(new q("selector-area row-header",!0).rect(t).target(e)),this}},{key:"addColHeaderArea",value:function(t,e){return this._areas.push(new q("selector-area col-header",!0).rect(t).target(e)),this}},{key:"addFocusArea",value:function(t,e){return this._focusAreas.push(new q("selector-focus",!0).rect(t).target(e)),this}},{key:"addCopyArea",value:function(t,e){var r=t.x,n=t.y,o=t.width,i=t.height;return this._copyAreas.push(new q("selector-copy",!0).rect({x:r-1,y:n-1,width:o-2,height:i-2}).target(e)),this}},{key:"showCopy",value:function(){this._copyRange=this._ranges.at(-1)}},{key:"clearCopy",value:function(){this._copyRange=null,this._copyAreas.forEach((function(t){t.clear()})),this._copyAreas.length=0}},{key:"clear",value:function(){[this._areas,this._focusAreas,this._copyAreas].forEach((function(t){t.forEach((function(t){return t.clear()})),t.length=0}))}}]),t}();function X(t,e,r){t.sort(e);var n=t[0],o=[];1===t.length&&o.push(n);for(var i=1;i<t.length;i+=1){var a=t[i];r(n,a)?n=n.union(a):(o.push(n),n=a)}return t.length>1&&o.push(n),o}function Y(t){var e,r=[],n=[],o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=V(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t._ranges);try{for(o.s();!(e=o.n()).done;){var i=e.value;if(i){var a=i.startRow,l=i.startCol,u=i.endRow,s=i.endCol;(a>0||u>0)&&r.push(h.Range.create(a,0,u,0)),(l>0||s>0)&&n.push(h.Range.create(0,l,0,s))}}}catch(t){o.e(t)}finally{o.f()}t._rowHeaderRanges=X(r,(function(t,e){return t.startRow-e.startRow}),(function(t,e){return t.intersectsRow(e.startRow,e.endRow)})),t._colHeaderRanges=X(n,(function(t,e){return t.startCol-e.startCol}),(function(t,e){return t.intersectsCol(e.startCol,e.endCol)}))}function Q(t){return function(t){if(Array.isArray(t))return Z(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||J(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(t,e){if(t){if("string"==typeof t)return Z(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(t,e):void 0}}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function et(){return c("div","".concat(t,"-overlayer-area"))}var rt=function(){function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=[],(r="areaRects")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this.areas=[et(),et(),et(),et()],this.headerAreas=[et(),et(),et(),et()],e.append.apply(e,Q(this.areas).concat(Q(this.headerAreas)))}var e,r;return e=t,(r=[{key:"area",value:function(t,e){if(e){this.areaRects[t]=e;var r=e.x,n=e.y,o=e.height,i=e.width;return this.areas[t].css({left:r,top:n,width:i,height:o}),this}return this.areas[t]}},{key:"headerArea",value:function(t,e){if(e){var r=e.x,n=e.y,o=e.height,i=e.width;this.headerAreas[t].css({left:r,top:n,width:i,height:o})}return this.headerAreas[t]}},{key:"inAreas",value:function(t){var e,r=t.x,n=t.y,o=t.height,i=r+t.width,a=n+o,l=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=J(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(this.areaRects);try{for(l.s();!(e=l.n()).done;){var u=e.value;if(r>=0&&i<=u.width&&n>=0&&a<=u.height)return!0}}catch(t){l.e(t)}finally{l.f()}return!1}}])&&tt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function nt(t,e,r){t.addEventListener(e,r)}function ot(t,e,r){t.removeEventListener(e,r)}function it(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ut=function(){function e(r,n,o,i){var a=this,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};it(this,e),lt(this,"_cell",null),this._type=r,this._minValue=o,this._lineLength=i,this._change=l,this._=c("div","".concat(t,"-resizer ").concat(r)).append(this._hover=c("div","hover").on("mousedown.stop",(function(t){return st(a,t)})),this._line=c("div","line")),n.append(this._)}var r,n;return r=e,(n=[{key:"show",value:function(t){this._cell=t;var e=this._type,r=t.x,n=t.y,o=t.width,i=t.height;this._.css("left","".concat("row"===e?r:r+o-5,"px")).css("top","".concat("row"===e?n+i-5:n,"px")).show();var a="row"===e?"width":"height";this._hover.css(a,"".concat(t[a],"px")),this._line.css(a,"".concat(this._lineLength(),"px"))}},{key:"hide",value:function(){this._.hide()}}])&&at(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function st(t,e){var r=t._type,n=t._cell,o=t._minValue,i=t._,a=t._line,l=t._change,u=0;a.show();var s=function(t){null!==e&&1===t.buttons&&n&&("row"===r?(u+=t.movementY)+n.height>=o?i.css("top","".concat(n.y+n.height+u,"px")):u=o-n.height:(u+=t.movementX)+n.width>=o?i.css("left","".concat(n.x+n.width+u,"px")):u=o-n.width)};nt(window,"mousemove",s),nt(window,"mouseup",(function t(){ot(window,"mousemove",s),ot(window,"mouseup",t),a.hide(),i.hide(),n&&0!=u&&l(u,n)}))}function ct(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ht(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ht(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ft(t){var e=t._selector,r=t._overlayer,n=t._container,o=t._renderer,i=o._rowHeader,a=o._colHeader,l=o.viewport;if(e&&l){var u=e._placement;e.clear();var s=i.width,c=a.height,h=t._width()-s,f=t._height()-c,d=function(t,n){l.areas.forEach((function(o,i){var a=r.areas[i];e._ranges.forEach((function(r,l){t(o.range,r)&&e.addArea(l,n(o,r,i),a)}));var l=e._focusRange,u=e._copyRange;l&&t(o.range,l)&&e.addFocusArea(n(o,l,i),a),u&&t(o.range,u)&&e.addCopyArea(n(o,u,i),a)}))},v=function(t,n){n.forEach((function(n){var o=l.headerAreas[n],i=r.headerAreas[n];"row"===t?e._rowHeaderRanges.forEach((function(t){o.range.intersectsRow(t.startRow,t.endRow)&&e.addRowHeaderArea(o.rectRow(t.startRow,t.endRow),i)})):e._colHeaderRanges.forEach((function(t){o.range.intersectsCol(t.startCol,t.endCol)&&e.addColHeaderArea(o.rectCol(t.startCol,t.endCol),i)}))}))};"all"===u?e.addArea(0,{x:s,y:c,width:h,height:f},n).addRowHeaderArea({x:0,y:c,width:s,height:f},n).addColHeaderArea({x:s,y:0,width:h,height:c},n):"row-header"===u?(d((function(t,e){return t.intersectsRow(e.startRow,e.endRow)}),(function(t,e,r){var n=t.rectRow(e.startRow,e.endRow);return n.width+=2,0!==r&&3!==r||(n.x-=2),n})),v("row",[2,3]),[0,1].forEach((function(t){e.addColHeaderArea({x:0,y:0,width:h,height:c},r.headerAreas[t])}))):"col-header"===u?(d((function(t,e){return t.intersectsCol(e.startCol,e.endCol)}),(function(t,e,r){var n=t.rectCol(e.startCol,e.endCol);return n.height+=2,2!==r&&3!==r||(n.y-=2),n})),v("col",[0,1]),[2,3].forEach((function(t){e.addRowHeaderArea({x:0,y:0,height:f,width:s},r.headerAreas[t])}))):(d((function(t,e){return t.intersects(e)}),(function(t,e){return t.rect(e)})),v("row",[2,3]),v("col",[0,1]))}}const dt={setCellValue:function(t,e){var r=t._selector;r&&(r.clearCopy(),r._ranges.forEach((function(r){r&&r.each((function(r,n){t.cell(r,n,{value:e})}))})),t.render())},reset:ft,move:function(t,e,r){var n=t._selector,o=t._data,i=t._vScrollbar,a=t._hScrollbar,l=t._renderer.viewport;if(n&&l){var u=ct(n._focus,2),s=u[0],c=u[1];if(n.move(e,r),!r)return"up"===e?null==i||i.scrollToStart():"down"===e?null==i||i.scrollToEnd():"left"===e?null==a||a.scrollToStart():"right"===e&&(null==a||a.scrollToEnd()),void ft(t);if(o.freeze&&("down"===e||"right"===e)){var f=ct((0,h.expr2xy)(o.freeze),2),d=f[0],v=f[1],y=ct(o.scroll,2),p=y[0],w=y[1];if(s+1===v&&p>0)return void(null==i||i.scrollToStart());if(c+1===d&&w>0)return void(null==a||a.scrollToStart())}var g=ct(l.areas,4)[3],b=ct(n._focus,2),_=b[0],m=b[1],k=g.range,R=k.startRow,x=k.startCol,C=k.endRow,A=k.endCol;if(l.inAreas(_,m)&&C!==_&&A!==m)ft(t);else{var S=n._focusRange,j=[Math.abs(_-s),Math.abs(m-c)],O=j[0],P=j[1];S&&(O+=S.rows,P+=S.cols),"up"===e?null==i||i.scrollBy(-t.rowsHeight(_,_+O),!0):"down"===e?null==i||i.scrollBy(t.rowsHeight(R,R+O),!0):"left"===e?null==a||a.scrollBy(-t.colsWidth(m,m+P),!0):"right"===e&&(null==a||a.scrollBy(t.colsWidth(x,x+P),!0))}}},showCopy:function(t){t._selector&&(t._selector.showCopy(),ft(t))},clearCopy:function(t){t._selector&&(t._selector.clearCopy(),ft(t))}},vt=function(t){t._rowResizer=new ut("row",t._container,t._minRowHeight,(function(){return t._width()}),(function(e,r){var n=r.row,o=r.height;t.rowHeight(n,o+e).render(),dt.reset(t),t._canvas.focus()})),t._colResizer=new ut("col",t._container,t._minColWidth,(function(){return t._height()}),(function(e,r){var n=r.col,o=r.width;t.colWidth(n,o+e).render(),dt.reset(t),t._canvas.focus()}))};function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var wt={vertical:"height",horizontal:"width"},gt=function(){function e(r,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),pt(this,"_value",0),pt(this,"_maxValue",0),pt(this,"_lastOffset",0),pt(this,"_change",null),this._type=r,this._content=c("div","content"),this._=c("div","".concat(t,"-scrollbar ").concat(r)).append(this._content).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,i=e.scrollLeft;if(o._change){var a="vertical"===r?n:i,l=a>o._value?"+":"-";o._change(l,a,t),o._value=a}})),n.append(this._)}var r,n;return r=e,(n=[{key:"value",get:function(){return this._value}},{key:"change",value:function(t){return this._change=t,this}},{key:"scrollBy",value:function(t,e){if(t){var r=this._value,n=this._maxValue,o=r+t;!0===e&&(o=o>=0&&o<=n?o<Math.abs(t)?0:o:n),this.scroll(o)}return this}},{key:"scrollToStart",value:function(){return this.scroll(0),this}},{key:"scrollToEnd",value:function(){return this.scroll(this._maxValue),this}},{key:"scroll",value:function(t){var e=this._,r=this._type;return void 0!==t?("vertical"===r?e.scrolly(t):e.scrollx(t),this):"vertical"===r?e.scrolly():e.scrollx()}},{key:"resize",value:function(t,e){if(e>t-1){var r=wt[this._type];this._content.css(r,"".concat(e,"px")),this._.css(r,"".concat(t,"px")).show(),this._maxValue=e-t}else this._.hide();return this}}])&&yt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mt=function(){function e(r,n,o,i,a){var l=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_t(this,"_",c("div","".concat(t,"-editor"))),_t(this,"_text",c("textarea","")),_t(this,"_textMeasure",c("div","measure")),_t(this,"_rect",null),_t(this,"_value",""),_t(this,"_editing",!1),_t(this,"_visible",!1),_t(this,"_inputChange",(function(){})),_t(this,"_moveChange",(function(){})),this._maxHeight=o,this._maxWidth=n,this._fontFamily=a,this._fontSize=i,r.append(this._),this._.append(this._text,this._textMeasure),this._text.on("keydown",(function(t){!function(t,e){var r=e.code,n=e.shiftKey,o=e.metaKey,i=e.altKey,a=e.ctrlKey,l=e.target,u=function(e){t._moveChange(e,t._value),t.hide()};"Enter"===r?(a||o||i?(l.value+="\n",t.value(l.value)):u(n?"up":"down"),e.preventDefault()):"Tab"!==r||a||o||i||(u(n?"left":"right"),e.preventDefault())}(l,t)})).on("input",(function(t){var e=t.target,r=e.value;l._editing=!0,l._value=r,l._inputChange(e.value),kt(l)}))}var r,n;return r=e,(n=[{key:"visible",get:function(){return this._visible}},{key:"target",value:function(t){return t.append(this._),this}},{key:"value",value:function(t){if(void 0===t)return this._value;this._value=t,this._text.value(t),kt(this)}},{key:"finished",value:function(){this._editing&&this._moveChange("none",this._value),this.hide()}},{key:"rect",value:function(t){var e=this;if(t){this._visible=!0,this._rect=t;var r=t.x,n=t.y,o=t.width,i=t.height;this._.css({left:r-1,top:n-1,width:o-2,height:i-2}).show(),setTimeout((function(){var t=e._value.length,r=e._text.element();r.focus(),r.setSelectionRange(t,t)}),0)}return this}},{key:"hide",value:function(){this._editing=!1,this._visible=!1,this.value(""),this._.hide()}},{key:"inputChange",value:function(t){this._inputChange=t}},{key:"moveChange",value:function(t){this._moveChange=t}}])&&bt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function kt(t){var e=t._value,r=t._rect,n=t._maxWidth,o=t._maxHeight,i=t._textMeasure,a=(e.split("\n"),e.replace("\n","<br/>"));if(e.endsWith("\n")&&(a+="T"),i.html(a),r){var l=n()-r.x,u=o()-r.y;i.css("maxWidth","".concat(l,"px"));var s=i.rect(),c=s.width,h=s.height;c>r.width-2&&c<l&&t._.css({width:c}),h>r.height&&h<u?t._.css({height:h}):h<r.height&&t._.css({height:r.height-2})}}const Rt=function(t){t._editor=new mt(t._container,t._width,t._height,"13px","Arial");var e=t._editor,r=t._selector;e.inputChange((function(t){})),e.moveChange((function(e,n){dt.setCellValue(t,n),"none"!==e&&r&&(dt.move(t,e),t._canvas.focus())}))},xt=function(t){var e=t._editor,r=t._selector;if(e&&r&&e.visible&&"body"===r._placement&&r._focusAreas.length>0){var n=r._focusAreas[0],o=n._rect,i=n._target;o&&i?e.rect(o).target(i):e.rect({x:-100,y:-100,width:0,height:0})}},Ct=function(t){var e=t._selector,r=t._editor;if(e&&r&&"body"===e._placement){var n=e._focusRange,o=e._focusAreas;if(n&&o.length>0){var i=o[0],a=i._rect,l=i._target;a&&l&&r.rect(a).target(l);var u=t.cell(n.startRow,n.startCol);u&&r.value(b(u))}}},At=function(t){t._vScrollbar=new gt("vertical",t._container).change((function(e,r){(function(t,e,r){return e&&void 0!==r?_(t,e,r,"row",(function(e){return D(t,e).height})):t.scroll[3]})(t._data,e,r)&&(t.render(),dt.reset(t),xt(t))})),t._hScrollbar=new gt("horizontal",t._container).change((function(e,r){(function(t,e,r){return e&&void 0!==r?_(t,e,r,"col",(function(e){return M(t,e).width})):t.scroll[2]})(t._data,e,r)&&(t.render(),dt.reset(t),xt(t))}))},St=function(t){var e=t._contentRect,r=e.x,n=e.y,o=e.height,i=e.width;t._vScrollbar&&t._vScrollbar.resize(t._height(),o+n),t._hScrollbar&&t._hScrollbar.resize(t._width(),i+r)};function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ot(t){t._canvas.on("mousedown",(function(e){return function(t,e){var r=t._selector,n=t._renderer,o=t._editor,i=n.viewport,a={row:0,col:0};if(r&&i){var l=e.offsetX,u=e.offsetY,s=e.ctrlKey,c=e.metaKey,h=e.shiftKey,f=i.cellAt(l,u);if(f){var d=f.placement,v=f.row,y=f.col;if(h?r.unionRange(v,y):(a={row:v,col:y},r.placement(d).addRange(v,y,!(c||s))),dt.reset(t),"all"!==d){var p=t._canvas.rect(),w=p.left,g=p.top,b=function(e){var n=0,o=0;e.x>0&&(n=e.x-w),e.y>0&&(o=e.y-g),"row-header"===d&&(n=1),"col-header"===d&&(o=1);var l=i.cellAt(n,o);if(l){var u=l.row,s=l.col;u==a.row&&s===a.col||(r.unionRange(u,s),dt.reset(t),a={row:u,col:s})}};nt(window,"mousemove",b),nt(window,"mouseup",(function t(){ot(window,"mousemove",b),ot(window,"mouseup",t)}))}}}o&&o.finished()}(t,e)})).on("mousemove",(function(e){return function(t,e){var r=t._rowResizer,n=t._colResizer,o=t._renderer.viewport,i=e.buttons,a=e.offsetX,l=e.offsetY;if(o&&0===i){var u=t._renderer,s=u._rowHeader,c=u._colHeader;if(r&&s.width>0)if(a<s.width&&l>c.height){var h=o.cellAt(a,l);h&&r.show(h)}else r.hide();if(n&&c.height>0)if(l<c.height&&a>s.width){var f=o.cellAt(a,l);f&&n.show(f)}else n.hide()}}(t,e)})).on("keydown",(function(e){return function(t,e){var r=e.ctrlKey,n=e.shiftKey,o=e.metaKey,i=e.altKey,a=e.code;console.log("code:",a,e);var l=null;if("Enter"!==a||r||o||i)if("Tab"!==a||r||o||i)if(a.startsWith("Arrow"))l=a.substring(5).toLowerCase();else if(r||o||i||!(a.startsWith("Key")||a.startsWith("Digit")||["Minus","Equal","Space","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"].includes(a)))if("KeyC"===a&&(r||o)){var u=t._selector;if(t._copyable&&u){var s={},c=u._ranges[0];c&&(dt.showCopy(t),["text/plain","text/html"].forEach((function(e){var r=c.toString(),n="text/html"===e?t.toHtml(r):function(t,e){var r=h.Range.with(e),n="";return r.eachRow((function(e){r.eachCol((function(r){var o=t.cellValueString(e,r);o.includes("\n")&&(o='"'.concat(o,'"')),n+="".concat(o,"\t")})),n+="\n"})),n}(t,r);s[e]=new Blob([n],{type:e})})),navigator.clipboard.write([new ClipboardItem(s)]).then((function(){return console.log("clipboard has writed success")}),(function(t){return console.log("clipboard has wirted failure: ",t)})))}}else"KeyV"===a&&(r||o)?t._editable&&navigator.clipboard.read().then((function(e){if(e.length>0){var r=e[0],o=n;o||(o=!Pt(r,"text/html",(function(e){t.fill(e).render()}))),o&&Pt(r,"text/plain",(function(e){t.fill(function(t){var e,r=[],n=0,o=0,i="",a=0,l=function(){var t;r[t=n]||(r[t]=[]),r[n][o]=i,i=""},u=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return jt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(u.s();!(e=u.n()).done;){var s=e.value;"\t"!==s?"\n"!==s||1===a?'"'!==s?"\r"!==s&&(i+=s):a+=1:(l(),n+=1,o=0):(l(),o+=1,a=0)}}catch(t){u.e(t)}finally{u.f()}return o>0&&l(),r.length<=0&&r.push([t]),r}(e)).render()}))}})):"Escape"===a&&dt.clearCopy(t);else Ct(t),e.preventDefault();else l=n?"left":"right";else l=n?"up":"down";l&&(dt.move(t,l,o||r?void 0:1),e.preventDefault())}(t,e)})).on("wheel.prevent",(function(e){return function(t,e){var r=e.deltaX,n=e.deltaY,o=t._hScrollbar,i=t._vScrollbar;Math.abs(r)>Math.abs(n)?o&&o.scrollBy(r):i&&i.scrollBy(n)}(t,e)})).on("dblclick.prevent",(function(){Ct(t)}))}function Pt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};return!!t.types.includes(e)&&(t.getType(e).then((function(t){t.text().then((function(t){console.log("[".concat(e,"]: ").concat(t)),r(t)}))})),!0)}function It(t){return function(t){if(Array.isArray(t))return Dt(t)}(t)||Tt(t)||Wt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tt(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Et(t,e){return Mt(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||Wt(t,e)||Ht()}function Ht(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mt(t){if(Array.isArray(t))return t}function zt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Wt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Wt(t,e){if(t){if("string"==typeof t)return Dt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dt(t,e):void 0}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Lt(t,e,r){if(t.hasAttribute(e)){var n=t.getAttribute(e);null!=n&&r(n)}}function Ft(t,e,r,n){var o=t.style.getPropertyValue(e),i=null!==o&&""!==o&&o!==r;return i&&n(o),i}function Vt(t,e,r,n){var o=t.style.getPropertyValue(e);o===r&&n(o)}function Bt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,l=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ut(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ut(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Gt,qt=function(){function e(r,n,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Kt(this,"_rendererOptions",{}),Kt(this,"_copyable",!1),Kt(this,"_editable",!1),Kt(this,"_minRowHeight",25),Kt(this,"_minColWidth",60),Kt(this,"_contentRect",{x:0,y:0,width:0,height:0}),Kt(this,"_cells",new w),Kt(this,"_vScrollbar",null),Kt(this,"_hScrollbar",null),Kt(this,"_rowResizer",null),Kt(this,"_colResizer",null),Kt(this,"_editor",null),Kt(this,"_selector",null),this._width=n,this._height=o;var a="string"==typeof r?document.querySelector(r):r;if(null===a)throw new Error("first argument error");if(this._container=c(a,"".concat(t,"-container")).css({height:o(),width:n()}),this._data={rows:{len:100},cols:{len:26},rowHeight:25,colWidth:100,scroll:[0,0,0,0],style:{color:"#333",align:"left",valign:"middle",textwrap:!1,bold:!1,italic:!1,fontFamily:"Roboto",fontSize:10,underline:!1,strikethrough:!1},styles:[],borders:[],merges:[],cells:[]},i){var l=i.minColWidth,u=i.minRowHeight,s=i.renderer,h=i.data;if(l&&(this._minColWidth=l),u&&(this._minRowHeight=u),s&&(this._rendererOptions=s),h){var d=h.cols,v=h.rows,y=h.rowHeight,p=h.colWidth,g=this._data;d&&(g.cols.len=d),v&&(g.rows.len=v),y&&(g.rowHeight=y),p&&(g.colWidth=p)}}var b=document.createElement("canvas");this._canvas=c(b).attr("tabIndex","1"),this._container.append(b),this._renderer=new(f())(b,n(),o()),this._overlayer=new rt(this._container),Nt(this),null!=i&&i.selectable&&(this._selector=new N(this._data,!!i.editable)),null!=i&&i.scrollable&&At(this),null!=i&&i.resizable&&vt(this),null!=i&&i.editable&&(this._editable=!0,Rt(this)),this._copyable=(null==i?void 0:i.copyable)||!1,Ot(this)}var r,n,o;return r=e,n=[{key:"contentRect",value:function(){return this._contentRect}},{key:"resize",value:function(){this._container.css({height:this._height(),width:this._width()}),this.render()}},{key:"freeze",value:function(t){return this._data.freeze=t,this}},{key:"isMerged",value:function(t){var e=this;if(t)return m(this._data,t);var r=this._selector;return!!r&&r._ranges.every((function(t){return m(e._data,t.toString())}))}},{key:"merge",value:function(t){var e=this;if(t)k(this._data,t);else{var r=this._selector;r&&r._ranges.forEach((function(t){return k(e._data,t.toString())}))}return this}},{key:"unmerge",value:function(t){var e=this;if(t)R(this._data,t);else{var r=this._selector;r&&r._ranges.forEach((function(t){return R(e._data,t.toString())}))}return this}},{key:"row",value:function(t,e){return e?(e.height&&this.rowHeight(t,e.height),D(this._data,t,e),this):D(this._data,t)}},{key:"rowHeight",value:function(t,e){var r=L(this._data,t);return e?(r!==e&&(L(this._data,t,e),this._contentRect.height+=e-r),this):r}},{key:"col",value:function(t,e){return e?(e.width&&this.colWidth(t,e.width),M(this._data,t,e),this):M(this._data,t)}},{key:"colWidth",value:function(t,e){var r=z(this._data,t);return e?(r!==e&&(z(this._data,t,e),this._contentRect.width+=e-r),this):r}},{key:"colsWidth",value:function(t,e){return W(this._data,t,e)}},{key:"rowsHeight",value:function(t,e){return F(this._data,t,e)}},{key:"formulaParser",value:function(t){return this._cells.formulaParser(t),this}},{key:"formatter",value:function(t){return this._cells.formatter(t),this}},{key:"style",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return S(this._data,t,e)}},{key:"addStyle",value:function(t){return function(t,e){if(t.styles||(t.styles=[]),e)for(var r=0;r<t.styles.length;r+=1)if(A(t.styles[r],e))return r;return t.styles.push(e)-1}(this._data,t)}},{key:"clearStyles",value:function(){return this._data.styles.length=0,this}},{key:"addBorder",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return H(this._data,e),this}},{key:"clearBorder",value:function(t){var e,r,n;return e=this._data,r=t,(n=e.borders)&&function(){for(var t=[],e=h.Range.with(r),o=function(r){var o=O(n[r]),a=o[0],l=o.slice(1),u=h.Range.with(a);u.intersects(e)&&(u.within(e)||u.difference(e).forEach((function(e){t.push([e.toString()].concat(j(l)))})),n.splice(r,1),r-=1),i=r},i=0;i<n.length;i+=1)o(i);n.push.apply(n,t)}(),this}},{key:"clearBorders",value:function(){return this._data.borders.length=0,this}},{key:"cell",value:function(t,e,r){var n=this._cells;if(r)return n.set(t,e,r),this;var o=n.get(t,e);return null!=o?o[2]:o}},{key:"cellValue",value:function(t,e){return g(this.cell(t,e))}},{key:"cellValueString",value:function(t,e){return b(this.cell(t,e))}},{key:"render",value:function(){var t=this,e=this._data,r=this._renderer,n=this._overlayer;for(var o in this._rendererOptions){var i=this._rendererOptions[o];i&&r[o](i)}r.scrollRows(e.scroll[0]).scrollCols(e.scroll[1]).merges(e.merges).freeze(e.freeze).styles(e.styles).borders(e.borders).rows(e.rows.len).cols(e.cols.len).row((function(t){return D(e,t)})).col((function(t){return M(e,t)})).cell((function(e,r){return t.cell(e,r)})).formatter(this._cells._formatter).render();var a=r.viewport;return a&&(a.areas.forEach((function(t,e){n.area(e,t)})),a.headerAreas.forEach((function(t,e){n.headerArea(e,t)})),St(this)),this}},{key:"data",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return t?(Object.assign(this._data,t),this._cells.load(this._data),Nt(this),this):this._data}))},{key:"fill",value:function(t,e){var r=this._selector,n=0,o=0;if(e){var i=Bt((0,h.expr2xy)(e),2);o=i[0],n=i[1]}else{if(!r)return this;var a=Bt(r._focus,2);n=a[0],o=a[1]}var l=0,u=0;if(Array.isArray(t)){for(var s=0;s<t.length;s+=1){var c=t[s];u=o+c.length-1;for(var f=0;f<c.length;f+=1)this.cell(n+s,o+f,c[f])}l=n+t.length-1}else if("string"==typeof t){var d=Bt(function(t,e,r){var n=Et(r,2),o=n[0],i=n[1],a=[0,0];if(e&&e.includes("</table>")){var l=t._data.style,u=document.createElement("template");u.innerHTML=e;var s=[],c=u.content.querySelectorAll("tr");a[0]=o+c.length-1;var f=[];if(c.forEach((function(e,r){var n=e.querySelectorAll("td");0===r&&(a[1]=i+n.length-1);for(var u=null,c=[],d=function(e){var f=n[e],d=r+o,v=e+i;s.length>0&&s.forEach((function(t){t.containsRow(d)&&t.startCol<=v&&(v+=t.cols,t.startRow!==d&&(v+=1))}));var y=(0,h.xy2expr)(v,d),p=1,w=1;if(Lt(f,"rowspan",(function(t){return p=parseInt(t)})),Lt(f,"colspan",(function(t){return w=parseInt(t)})),p>1||w>1){var g=h.Range.create(d,v,d+p-1,v+w-1);t.merge(g.toString()),s.push(g)}0===r&&(a[1]+=w-1);var b={};Ft(f,"background-color","",(function(t){return b.bgcolor=t})),Ft(f,"color",l.color,(function(t){return b.color=t})),Ft(f,"text-align",l.align,(function(t){return b.align=t})),Ft(f,"vertical-align",l.valign,(function(t){return b.valign=t})),Vt(f,"white-space","normal",(function(t){return b.textwrap=!0})),Vt(f,"text-decoration","underline",(function(t){return b.underline=!0})),Vt(f,"text-decoration","line-through",(function(t){return b.strikethrough=!0})),Vt(f,"font-style","italic",(function(t){return b.italic=!0})),Ft(f,"font-weight","normal",(function(t){("bold"===t||parseInt(t)>=700)&&(b.bold=!0)})),Ft(f,"font-family",l.fontFamily,(function(t){return b.fontFamily=t})),Ft(f,"font-size",l.fontSize,(function(t){return b.fontSize=parseInt(t)}));var _=function(t){var e,r,n=Mt(e=t.split(" ").map((function(t){return t.trim()})))||Tt(e)||Wt(e)||Ht(),o=n[0],i=n[1],a=n.slice(2),l="thin";if("solid"===i){var u=parseInt(o);o.includes("pt")&&(u=(r=parseInt(o))<=.75?1:r<=1.5?2:r<=2.25?3:r<=3?4:r<=3.75?5:r<=4.5?6:96/72*r),2===u?l="medium":3===u&&(l="thick")}else l=i;return[l,a.join("")]},m=[],k=null;Ft(f,"border-width","",(function(t){return m.push(t)})),Ft(f,"border-style","",(function(t){return m.push(t)})),Ft(f,"border-color","",(function(t){return m.push(t)})),m.length>=3?k=[y,"all"].concat(It(_(m.join(" ")))):Ft(f,"border","none",(function(t){return k=[y,"all"].concat(It(_(t)))}))||["top","right","bottom","left"].forEach((function(t){Ft(f,"border-".concat(t),"none",(function(e){return k=[y,t].concat(It(_(e)))}))})),null===u?null!==k&&(u=k):null!==k&&k[1]===u[1]&&k[2]===u[2]&&k[3]===u[3]?u[0]="".concat(u[0].split(":")[0],":").concat(y):(c.push(u),u=k);var R=f.innerHTML.replace(/<br(\/){0,1}>/gi,"\n").replace(/(<([^>]+)>|)/gi,"").replace("&nbsp;"," "),x={};Object.keys(b).length>0&&(x.style=t.addStyle(b)),null===R||/^\s*$/.test(R)||(x.value=R),Object.keys(x).length>0&&t.cell(d,v,x)},v=0;v<n.length;v+=1)d(v);null!=u&&c.push(u);var y=f.at(-1);if(y&&y.length>0)if(1===y.length&&1===c.length&&"all"===y[0][1]&&y[0][1]===c[0][1]&&y[0][2]===c[0][2]&&y[0][3]===c[0][3]){var p=h.Range.with(y[0][0]);p.endRow+=1,y[0][0]=p.toString()}else f.push(c);else f.push(c)})),f.length>0){var d,v=zt(f);try{for(v.s();!(d=v.n()).done;)d.value.forEach((function(e){return t.addBorder.apply(t,It(e))}))}catch(t){v.e(t)}finally{v.f()}}}return a}(this,t,[n,o]),2);l=d[0],u=d[1]}return(l>0||u>0)&&(null==r||r.unionRange(l,u),dt.reset(this)),this}},{key:"toHtml",value:function(t){return function(t,e){var r,n='<table xmlns="http://www.w3.org/1999/xhtml" style="border-spacing: 0; border-collapse: collapse;">',o=h.Range.with(e),i=t._data.merges.map((function(t){return h.Range.with(t)})).filter((function(t){return t.intersects(o)})),a=new Map,l=zt(t._data.borders);try{var u=function(){var t=Et(r.value,4),e=t[0],n=t[1],i=t[2],l=t[3],u=h.Range.with(e);if(u.intersects(o)){var s=u.startRow,c=u.startCol,f=u.endRow,d=u.endCol;u.each((function(t,e){var r=function(t,e){return"dashed"===t||"dotted"===t?"1px ".concat(t," ").concat(e):"".concat("thick"===t?3:"medium"===t?2:1,"px solid ").concat(e)}(i,l),o=[];"all"===n&&o.push("border"),"outside"!==n&&"left"!==n||e===c&&o.push("border-left"),"outside"!==n&&"right"!==n||e===d&&o.push("border-right"),"outside"!==n&&"top"!==n||t===s&&o.push("border-top"),"outside"!==n&&"bottom"!==n||t===f&&o.push("border-bottom"),"inside"!==n&&"vertical"!==n||e>=c&&e<d&&o.push("border-right"),"inside"!==n&&"horizontal"!==n||t>=s&&t<f&&o.push("border-bottom"),o.length>0&&a.set("".concat(t,"_").concat(e),o.map((function(t){return"".concat(t,":").concat(r,";")})).join(""))}))}};for(l.s();!(r=l.n()).done;)u()}catch(t){l.e(t)}finally{l.f()}return n+="<colgroup>",o.eachCol((function(e){n+='<col width="'.concat(t.colWidth(e),'"/>')})),n+="</colgroup>",n+="<tbody>",o.eachRow((function(e){n+='<tr style="height: '.concat(t.rowHeight(e),'px;">'),o.eachCol((function(r){var o,l,u,s=t.cell(e,r),c=h.Range.create(e,r),f=!1,d=1,v=1,y=zt(i);try{for(y.s();!(o=y.n()).done;){var p=o.value;if(p.startRow===e&&p.startCol===r){d=p.rows+1,v=p.cols+1;break}if(p.intersects(c)){f=!0;break}}}catch(t){y.e(t)}finally{y.f()}if(!f){n+="<td",d>1&&(n+=' rowspan="'.concat(d,'"')),v>1&&(n+=' colspan="'.concat(v,'"'));var w="",g="".concat(e,"_").concat(r);a.has(g)&&(w+=a.get(g)),s&&s instanceof Object&&void 0!==s.style&&(w+=(u="",(l=t.style(s.style,!0)).bgcolor&&(u+="background-color: ".concat(l.bgcolor,";")),l.color&&(u+="color: ".concat(l.color,";")),l.align&&(u+="text-align: ".concat(l.align,";")),l.valign&&(u+="vertical-align: ".concat(l.valign,";")),!0===l.textwrap&&(u+="white-space: normal;"),!0===l.underline&&(u+="text-decoration: underline;"),!0===l.strikethrough&&(u+="text-decoration: line-through;"),!0===l.bold&&(u+="font-weight: bold;"),!0===l.italic&&(u+="font-style: italic;"),l.fontFamily&&(u+="font-family: ".concat(l.fontFamily,";")),l.fontSize&&(u+="font-size: ".concat(l.fontSize,"pt;")),u)),""!==w&&(n+=' style="'.concat(w,'"')),n+=">".concat(t.cellValueString(e,r),"</td>")}})),n+="</tr>"})),n+"</tbody></table>"}(this,t)}},{key:"toArrays",value:function(t){var e=this,r=h.Range.with(t),n=[];return r.eachRow((function(t){var o=[];r.eachCol((function(r){o.push(e.cellValue(t,r))})),n.push(o)})),n}}],o=[{key:"create",value:function(t,r,n,o){return new e(t,r,n,o)}}],n&&$t(r.prototype,n),o&&$t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function Nt(t){t._contentRect={x:t._renderer._rowHeader.width,y:t._renderer._colHeader.height,width:W(t._data),height:F(t._data)}}window&&((Gt=window).wolf||(Gt.wolf={}),window.wolf.table=qt.create)})(),module.exports=n})();