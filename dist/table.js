(()=>{var t={402:t=>{(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{Area:()=>p,Range:()=>d,Viewport:()=>q,default:()=>Q,eachRanges:()=>v,expr2xy:()=>s,findRanges:()=>y,stringAt:()=>o,xy2expr:()=>l});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function i(t){return n.charAt(t%n.length)}function o(t){for(var e=[];t>=0;)e.push(i(t)),t=parseInt(t/n.length+"",10)-1;return e.reverse().join("")}function a(t){for(var e=0,r=0;r<t.length;r++)e=26*e+t.charCodeAt(r)-64;return e-1}function s(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n).toUpperCase();return[a(e),parseInt(r,10)-1]}function l(t,e){return"".concat(o(t)).concat(e+1)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startRow=e,this.startCol=r,this.endRow=n,this.endCol=i}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n,i){if(void 0!==n&&void 0!==i){var o=e,a=r,s=n,l=i;return e>n&&(o=n,s=e),r>i&&(a=i,l=r),new t(o,a,s,l)}return new t(e,r,e,r)}},{key:"with",value:function(t){var e=t.split(":"),r=u(s(e[0]),2),n=r[0],i=r[1];if(1===e.length)return this.create(i,n);var o=u(s(e[1]),2),a=o[0],l=o[1];return this.create(i,n,l,a)}}],(r=[{key:"start",get:function(){return[this.startRow,this.startCol]}},{key:"end",get:function(){return[this.endRow,this.endCol]}},{key:"rows",get:function(){return this.endRow-this.startRow}},{key:"cols",get:function(){return this.endCol-this.startCol}},{key:"multiple",get:function(){return this.cols>0||this.rows>0}},{key:"containsRow",value:function(t){return this.startRow<=t&&t<=this.endRow}},{key:"containsCol",value:function(t){return this.startCol<=t&&t<=this.endCol}},{key:"contains",value:function(t,e){return this.containsRow(t)&&this.containsCol(e)}},{key:"within",value:function(t){return this.startRow>=t.startRow&&this.startCol>=t.startCol&&this.endRow<=t.endRow&&this.endCol<=t.endCol}},{key:"intersectsRow",value:function(t,e){return this.startRow<=e&&t<=this.endRow}},{key:"intersectsCol",value:function(t,e){return this.startCol<=e&&t<=this.endCol}},{key:"intersects",value:function(t){var e=t.startRow,r=t.startCol,n=t.endRow,i=t.endCol;return this.intersectsCol(r,i)&&this.intersectsRow(e,n)}},{key:"intersection",value:function(e){return new t(e.startRow<this.startRow?this.startRow:e.startRow,e.startCol<this.startCol?this.startCol:e.startCol,e.endRow>this.endRow?this.endRow:e.endRow,e.endCol>this.endCol?this.endCol:e.endCol)}},{key:"union",value:function(e){return new t(e.startRow<this.startRow?e.startRow:this.startRow,e.startCol<this.startCol?e.startCol:this.startCol,e.endRow>this.endRow?e.endRow:this.endRow,e.endCol>this.endCol?e.endCol:this.endCol)}},{key:"difference",value:function(e){if(!this.intersects(e))return[];var r=this.startRow,n=this.startCol,i=this.endRow,o=this.endCol,a=this.intersection(e);return[new t(r,n,a.startRow-1,o),new t(a.endRow+1,n,i,o),new t(a.startRow,n,a.endRow,a.startCol-1),new t(a.startRow,a.endCol+1,a.endRow,o)].filter((function(t){return t.rows>=0&&t.cols>=0}))}},{key:"eachRow",value:function(t,e){var r=this.endRow;e&&r>e&&(r=e);for(var n=this.startRow;n<=r;n+=1)t(n);return this}},{key:"eachCol",value:function(t,e){var r=this.endCol;e&&r>e&&(r=e);for(var n=this.startCol;n<=r;n+=1)t(n);return this}},{key:"each",value:function(t){var e=this;return this.eachRow((function(r){e.eachCol((function(e){return t(r,e)}))})),this}},{key:"clone",value:function(){return new t(this.startRow,this.startCol,this.endRow,this.endCol)}},{key:"toString",value:function(){var t=l(this.startCol,this.startRow);return this.multiple&&(t+=":".concat(l(this.endCol,this.endRow))),t}},{key:"equals",value:function(t){return this.startRow===t.startRow&&this.startCol===t.startCol&&this.endRow===t.endRow&&this.endCol===t.endCol}}])&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function v(t,e){t&&t.length>0&&t.forEach((function(t){e(d.with(t))}))}function y(t,e){if(t&&t.length>0){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(t);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=d.with(i);if(e(o))return o}}catch(t){n.e(t)}finally{n.f()}}return null}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(){function t(e,r,n,i,o){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),g(this,"width",0),g(this,"height",0),g(this,"rowMap",new Map),g(this,"colMap",new Map),g(this,"cellAtCache",null),this.range=e,this.x=r,this.y=n,this.rowHeight=i,this.colWidth=o,e.eachRow((function(t){var e=i(t);a.rowMap.set(t,{y:a.height,height:e}),a.height+=e})),e.eachCol((function(t){var e=o(t);a.colMap.set(t,{x:a.width,width:e}),a.width+=e}))}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n,i,o,a,s,l){return new t(new d(e,r,n,i),o,a,s,l)}}],(r=[{key:"containsx",value:function(t){return t>=this.x&&t<this.x+this.width}},{key:"containsy",value:function(t){return t>=this.y&&t<this.y+this.height}},{key:"contains",value:function(t,e){return this.containsx(t)&&this.containsy(e)}},{key:"eachRow",value:function(t){var e=this;this.range.eachRow((function(r){var n=e.rowMap.get(r)||{y:0,height:0},i=n.y,o=n.height;o>0&&t(r,i,o)}))}},{key:"eachCol",value:function(t){var e=this;this.range.eachCol((function(r){var n=e.colMap.get(r)||{x:0,width:0},i=n.x,o=n.width;o>0&&t(r,i,o)}))}},{key:"each",value:function(t){var e=this;this.eachRow((function(r,n,i){e.eachCol((function(e,o,a){t(r,e,{x:o,y:n,width:a,height:i})}))}))}},{key:"rectRow",value:function(t,e){var r,n=this.rowMap,i=this.range,o=0,a=0;t>=i.startRow&&(o=(null===(r=n.get(t))||void 0===r?void 0:r.y)||0);for(var s=t;s<=e;s+=1){var l=this.rowHeight(s);l>0&&(s<i.startRow&&(o-=l),a+=l)}return{x:0,y:o,width:this.width,height:a}}},{key:"rectCol",value:function(t,e){var r,n=this.colMap,i=this.range,o=0,a=0;t>=i.startCol&&(o=(null===(r=n.get(t))||void 0===r?void 0:r.x)||0);for(var s=t;s<=e;s+=1){var l=this.colWidth(s);l>0&&(s<i.startCol&&(o-=l),a+=l)}return{x:o,y:0,width:a,height:this.height}}},{key:"rect",value:function(t){var e=this.rectRow(t.startRow,t.endRow),r=e.y,n=e.height,i=this.rectCol(t.startCol,t.endCol);return{x:i.x,y:r,width:i.width,height:n}}},{key:"cellAt",value:function(t,e){var r=this.cellAtCache;if(null!=r&&t>r.x&&t<=r.x+r.width&&e>r.y&&e<=r.y+r.height)return r;for(var n=this.range,i={row:n.startRow,col:n.startCol,x:this.x,y:this.y,width:0,height:0};i.y<e;){var o=this.rowHeight(i.row++);i.y+=o,i.height=o}for(i.y-=i.height,i.row--;i.x<t;){var a=this.colWidth(i.col++);i.x+=a,i.width=a}return i.x-=i.width,i.col--,this.cellAtCache=i,i}}])&&w(e.prototype,r),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function m(t){return"medium"===t?2:"thick"===t?3:1}var b=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e;var n=e.getContext("2d");if(!n)throw new Error("getContext(2d) is null");this._ctx=n,this._scale=r,this._target=e}var e,r;return e=t,(r=[{key:"size",value:function(t,e){var r=this._target,n=this._scale;r.style.width="".concat(t,"px"),r.style.height="".concat(e,"px");var i=window.devicePixelRatio;return r.width=Math.floor(t*i),r.height=Math.floor(e*i),this._ctx.scale(i*n,i*n),this}},{key:"attr",value:function(t,e){var r=this;return e?(this._ctx[t]=e,this):"string"==typeof t?this._ctx[t]:(Object.entries(t).forEach((function(t){var e,n=function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),2!==o.length);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e)||function(t,e){if(t){if("string"==typeof t)return _(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(t,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=n[0],o=n[1];null!=o&&(r._ctx[i]=o)})),this)}},{key:"measureTextWidth",value:function(t){return this.measureText(t).width}},{key:"line",value:function(t,e,r,n,i){return i&&(this.beginPath().attr({lineWidth:1,strokeStyle:i.color}),"medium"===i.type?this.attr({lineWidth:2}):"thick"===i.type?this.attr({lineWidth:3}):"dashed"===i.type?this.setLineDash([3,2]):"dotted"===i.type&&this.setLineDash([1,1])),this.moveTo(t,e).lineTo(r,n).stroke(),this}},{key:"clearRect",value:function(t,e,r,n){return this._ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this._ctx.fillRect(t,e,r,n),this}},{key:"strokeRect",value:function(t,e,r,n){return this._ctx.strokeRect(t,e,r,n),this}},{key:"fillText",value:function(t,e,r,n){return this._ctx.fillText(t,e,r,n),this}},{key:"strokeText",value:function(t,e,r,n){return this._ctx.strokeText(t,e,r,n),this}},{key:"measureText",value:function(t){return this._ctx.measureText(t)}},{key:"getLineDash",value:function(){return this._ctx.getLineDash()}},{key:"setLineDash",value:function(t){return this._ctx.setLineDash(t),this}},{key:"createLinearGradient",value:function(t,e,r,n){return this._ctx.createLinearGradient(t,e,r,n)}},{key:"createRadialGradient",value:function(t,e,r,n,i,o){return this._ctx.createRadialGradient(t,e,r,n,i,o)}},{key:"createPattern",value:function(t,e){return this._ctx.createPattern(t,e)}},{key:"beginPath",value:function(){return this._ctx.beginPath(),this}},{key:"closePath",value:function(){return this._ctx.closePath(),this}},{key:"moveTo",value:function(t,e){return this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this._ctx.lineTo(t,e),this}},{key:"bezierCurveTo",value:function(t,e,r,n,i,o){return this.bezierCurveTo(t,e,r,n,i,o),this}},{key:"quadraticCurveTo",value:function(t,e,r,n){return this.quadraticCurveTo(t,e,r,n),this}},{key:"arc",value:function(t,e,r,n,i,o){return this._ctx.arc(t,e,r,n,i,o),this}},{key:"arcTo",value:function(t,e,r,n,i){return this._ctx.arcTo(t,e,r,n,i),this}},{key:"ellipse",value:function(t,e,r,n,i,o,a,s){return this._ctx.ellipse(t,e,r,n,i,o,a,s),this}},{key:"rect",value:function(t,e,r,n){return this._ctx.rect(t,e,r,n),this}},{key:"roundRect",value:function(t,e,r,n,i){return this.beginPath().moveTo(t+i,e).arcTo(t+r,e,t+r,e+n,i).arcTo(t+r,e+n,t,e+n,i).arcTo(t,e+n,t,e,i).arcTo(t,e,t+r,e,i).closePath(),this}},{key:"fill",value:function(t){return this._ctx.fill(t),this}},{key:"stroke",value:function(){return this._ctx.stroke(),this}},{key:"clip",value:function(t){return this._ctx.clip(t),this}},{key:"isPointInPath",value:function(t,e,r){return this._ctx.isPointInPath(t,e,r)}},{key:"isPointInStroke",value:function(t,e){return this._ctx.isPointInStroke(t,e)}},{key:"getTransform",value:function(){return this._ctx.getTransform()}},{key:"rotate",value:function(t){return this._ctx.rotate(t),this}},{key:"scale",value:function(t,e){return this._ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this._ctx.translate(t,e),this}},{key:"setTransform",value:function(t,e,r,n,i,o){return this._ctx.setTransform(t,e,r,n,i,o),this}},{key:"drawImage",value:function(t,e,r){return this._ctx.drawImage(t,e,r),this}},{key:"createImageData",value:function(t,e){return this._ctx.createImageData(t,e)}},{key:"getImageData",value:function(t,e,r,n){return this._ctx.getImageData(t,e,r,n)}},{key:"putImageData",value:function(t,e,r){return this._ctx.putImageData(t,e,r),this}},{key:"save",value:function(){return this._ctx.save(),this}},{key:"restore",value:function(){return this._ctx.restore(),this}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t,e){if(t){if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(t,e):void 0}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function R(t,e,r,n){if(t&&e){var i="";return r&&(i+="italic "),n&&(i+="bold "),"".concat(i," ").concat(e,"pt ").concat(t)}}function C(t,e,r){var n,i,o,a,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(r)?n=i=o=a=r:(n=r.top,i=r.right,o=r.bottom,a=r.left);var l=0;n&&s&&(l=m(n[0])/2),t.save().translate(e.x,e.y),n&&t.line(0-l,0,e.width+l,0,{type:n[0],color:n[1]}),i&&t.line(e.width,0,e.width,e.height,{type:i[0],color:i[1]}),o&&t.line(0-l,e.height,e.width+l,e.height,{type:o[0],color:o[1]}),a&&t.line(0,0,0,e.height,{type:a[0],color:a[1]}),t.restore()}function S(t,e,r,n,i,o){var a="";e&&("string"==typeof e||"number"==typeof e?a=o("".concat(e)):(e.type,a=o((e.value||"")+"",e.format)));var s,l=n.fontSize,u=n.fontName,c=n.bold,h=n.italic,f=n.color,d=n.bgcolor,v=n.align,y=n.valign,w=n.underline,g=n.strikethrough,p=n.rotate,_=n.textwrap,m=n.padding;if(t.save().beginPath().translate(r.x,r.y),t.attr("fillStyle",d).rect(0,0,r.width,r.height).clip().fill(),p&&p>0&&t.rotate(p*(Math.PI/180)),void 0!==i){if(t.save(),!i(t,r,e,a))return void t.restore();t.restore()}if(a&&!/^\s*$/.test(a)){t.save().beginPath().attr({textAlign:v,textBaseline:y,font:R(u,l,h,c),fillStyle:f});var b=function(t){if(Array.isArray(t))return t}(s=m||[5,5])||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),2!==o.length);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(s)||k(s,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),C=b[0],S=b[1],A=function(t,e,r){switch(t){case"left":return r;case"center":return e/2;case"right":return e-r;default:return 0}}(v,r.width,C),j=a.split("\n"),O=r.width-2*C,T=[];j.forEach((function(e){var r=t.measureTextWidth(e);if(_&&r>O){for(var n={w:0,len:0,start:0},i=0;i<e.length;i+=1)n.w>O&&(T.push(e.substr(n.start,n.len)),n={w:0,len:0,start:i}),n.len+=1,n.w+=t.measureTextWidth(e[i])+1;n.len>0&&T.push(e.substr(n.start,n.len))}else T.push(e)}));var E=l/.75,P=(T.length-1)*E,H=[];w&&H.push("underline"),g&&H.push("strikethrough");var I=function(t,e,r,n,i){switch(t){case"top":return i;case"middle":var o=e/2-r/2,a=n/2+i;return o<a?a:o;case"bottom":return e-i-r;default:return 0}}(y,r.height,P,E,S);T.forEach((function(e){var r=t.measureTextWidth(e);t.fillText(e,A,I),H.forEach((function(e){t.line.apply(t,function(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(function(t,e,r,n,i,o,a){var s=0;"underline"===t?"top"===r?s=-a:"middle"===r&&(s=-a/2):"strikethrough"===t&&("top"===r?s=-a/2:"bottom"===r&&(s=a/2));var l=0;return"center"===e?l=o/2:"right"===e&&(l=o),[n-l,i-s,n-l+o,i-s]}(e,v,y,A,I,r,l)))})),I+=E})),t.restore()}t.restore()}function A(t){return function(t){if(Array.isArray(t))return O(t)}(t)||T(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function T(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function E(t,e,r){var n,i=function(t){if(Array.isArray(t))return t}(n=e)||T(n)||j(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=i[0],a=i[1],s=i.slice(2),l=[],u=d.with(o),c=r.filter((function(t){return t.intersects(u)}));if(u.intersects(t.range)||c.length>0)if(c.length<=0)l.push([u,t.rect(u),a]);else{var h,f=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=j(t))){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(c);try{var v=function(){var e=h.value;if(!u.within(e)){if("outside"===a||"left"===a||"top"===a||"right"===a||"bottom"===a)return l.push([u,t.rect(u),a]),"break";var r=c.filter((function(t){return!t.equals(e)}));if(u.difference(e).forEach((function(n){if(n.intersects(t.range)){var i=t.rect(n);l.push.apply(l,A(E(t,[n.toString(),a].concat(A(s)),r))),"inside"!==a&&"horizontal"!==a||(n.startRow<e.startRow&&n.endRow<e.startRow?l.push([n,i,"bottom"]):n.startRow>e.startRow&&n.endRow>e.startRow&&l.push([n,i,"top"])),"inside"!==a&&"vertical"!==a||(n.startCol<e.startCol&&n.endCol<e.startCol&&l.push([n,i,"right"]),n.startCol>e.startCol&&n.endCol>e.startCol&&l.push([n,i,"left"]))}})),"all"===a){var n=t.rect(e);u.startRow===e.startRow&&l.push([e,n,"top"]),u.endRow===e.endRow&&l.push([e,n,"bottom"]),u.startCol===e.startCol&&l.push([e,n,"left"]),u.endCol===e.endCol&&l.push([e,n,"right"])}return"break"}u.startRow===e.startRow&&u.startCol===e.startCol&&"inside"!==a&&"horizontal"!==a&&"vertical"!==a&&l.push([e,t.rect(e),"all"===a?"outside":a])};for(f.s();!(h=f.n()).done&&"break"!==v(););}catch(t){f.e(t)}finally{f.f()}}return l}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function H(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function z(t,e,r){var n=e.width,i=e.color;n>0&&(t.save().beginPath().attr({lineWidth:n,strokeStyle:i}),r(),t.restore())}function W(t,e,r,n,i,o,a,s,l,u,c,h){if(e){t.save().translate(e.x,e.y),t.rect(0,0,e.width,e.height).clip();var f=function(t,e,r){var n=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){H(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},o);if(c){var i=c(t);i&&void 0!==i.style&&Object.assign(n,s[i.style])}if(h){var a=h(e);a&&void 0!==a.style&&Object.assign(n,s[a.style])}return r instanceof Object&&void 0!==r.style&&Object.assign(n,s[r.style]),n};e.each((function(e,o,a){var s=r(e,o),l=f(e,o,s);S(t,s,a,l,n,i)})),function(t,e,r){z(t,r,(function(){e.eachRow((function(r,n,i){t.line(0,n+i,e.width,n+i)})),e.eachCol((function(r,n,i){t.line(n+i,0,n+i,e.height)}))}))}(t,e,a);var d=[];l&&v(l,(function(o){if(o.intersects(e.range)){var a=r(o.startRow,o.startCol),s=f(o.startRow,o.startCol,a),l=e.rect(o);S(t,a,l,s,n,i),d.push(o)}})),function(t,e,r,n){r&&r.length>0&&r.forEach((function(r){var i=I(r,4),o=i[2],a=i[3];E(e,r,n).forEach((function(r){var n=I(r,3),i=n[0],s=n[1],l=n[2];!function(t,e,r,n,i,o,a,s){var l=[o,a];"outside"===i||"all"===i?C(t,n,l,!0):"left"===i?C(t,n,{left:l},s):"top"===i?C(t,n,{top:l},s):"right"===i?C(t,n,{right:l},s):"bottom"===i&&C(t,n,{bottom:l},s),"all"!==i&&"inside"!==i&&"horizontal"!==i&&"vertical"!==i||("horizontal"!==i&&r.eachCol((function(n){if(n<r.endCol){var i=r.clone();i.endCol=i.startCol=n,i.intersects(e.range)&&C(t,e.rect(i),{right:l},s)}})),"vertical"!==i&&r.eachRow((function(n){if(n<r.endRow){var i=r.clone();i.endRow=i.startRow=n,i.intersects(e.range)&&C(t,e.rect(i),{bottom:l},s)}})))}(t,e,i,s,l,o,a)}))}))}(t,e,u,d),t.restore()}}function M(t,e,r){W(t,e,r._cell,r._cellRenderer,r._formatter,r._cellStyle,r._lineStyle,r._styles,r._merges,r._borders,r._row,r._col)}function D(t,e,r){var n=r._rowHeader,i=n.cell,o=n.width,a=n.merges,s=n.cellRenderer;o>0&&W(t,e,i,s,(function(t){return t}),r._headerCellStyle,r._headerLineStyle,r._styles,a)}function N(t,e,r){var n=r._colHeader,i=n.cell,o=n.height,a=n.merges,s=n.cellRenderer;o>0&&W(t,e,i,s,(function(t){return t}),r._headerCellStyle,r._headerLineStyle,r._styles,a)}function B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function F(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?B(Object(r),!0).forEach((function(e){K(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function K(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=V(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(t,e)||V(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,e){if(t){if("string"==typeof t)return $(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(t,e):void 0}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._render=e;for(var r=[e._rowHeader.width,e._colHeader.height],n=r[0],i=r[1],o=U(e._freeze,2),a=o[0],s=o[1],l=e._startRow,u=e._startCol,c=e._rows,h=e._cols,f=function(t){return e.rowHeightAt(t)},d=function(t){return e.colWidthAt(t)},v=p.create(l,u,s-1,a-1,n,i,f,d),y=s+e._scrollRows,w=a+e._scrollCols,g=v.height,_=y;g<e._height&&_<c;)g+=f(_),_+=1;for(var m=v.width,b=w;m<e._width&&b<h;)m+=d(b),b+=1;var k=p.create(y,w,_-1,b-1,n+v.width,i+v.height,f,d),x=p.create(l,w,s-1,b-1,n+v.width,i,f,d),R=p.create(y,u,_-1,a-1,n,i+v.height,f,d);this.areas=[x,v,R,k];var C=e._rowHeader,S=e._colHeader,A=function(){return S.height/S.rows},j=function(){return C.width/C.cols};this.headerAreas=[p.create(0,x.range.startCol,S.rows-1,x.range.endCol,k.x,0,A,d),p.create(0,v.range.startCol,S.rows-1,v.range.endCol,v.x,0,A,d),p.create(v.range.startRow,0,v.range.endRow,C.cols-1,0,v.y,f,j),p.create(R.range.startRow,0,R.range.endRow,C.cols-1,0,k.y,f,j)]}var e,r;return e=t,(r=[{key:"inAreas",value:function(t,e){var r,n=G(this.areas);try{for(n.s();!(r=n.n()).done;)if(r.value.range.contains(t,e))return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"cellAt",value:function(t,e){var r=this.areas[1],n=U(this.headerAreas,4),i=n[0],o=n[1],a=n[2],s=n[3];if(t<r.x&&e<r.y)return{placement:"all",row:0,col:0,x:0,y:0,width:r.x,height:r.y};if(t<r.x)return F({placement:"row-header"},(a.containsy(e)?a:s).cellAt(t,e));if(e<r.y)return F({placement:"col-header"},(o.containsx(t)?o:i).cellAt(t,e));var l,u=G(this.areas);try{for(u.s();!(l=u.n()).done;){var c=l.value;if(c.contains(t,e))return F({placement:"body"},c.cellAt(t,e))}}catch(t){u.e(t)}finally{u.f()}return null}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function X(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Q=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),X(this,"_width",0),X(this,"_height",0),X(this,"_scale",1),X(this,"_rows",100),X(this,"_cols",26),X(this,"_rowHeight",22),X(this,"_colWidth",100),X(this,"_startRow",0),X(this,"_startCol",0),X(this,"_scrollRows",0),X(this,"_scrollCols",0),X(this,"_row",(function(){})),X(this,"_col",(function(){})),X(this,"_cell",(function(){})),X(this,"_cellRenderer",(function(){return!0})),X(this,"_formatter",(function(t){return t})),X(this,"_merges",[]),X(this,"_borders",[]),X(this,"_styles",[]),X(this,"_lineStyle",{width:1,color:"#e6e6e6"}),X(this,"_cellStyle",{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,underline:!1,strikethrough:!1,color:"#0a0a0a",bold:!1,italic:!1,rotate:0,fontSize:10,fontName:"Source Sans Pro"}),X(this,"_rowHeader",{width:60,cols:1,cell:function(t,e){return t+1}}),X(this,"_colHeader",{height:24,rows:1,cell:function(t,e){return o(e)}}),X(this,"_headerLineStyle",{width:1,color:"#e6e6e6"}),X(this,"_headerCellStyle",{bgcolor:"#f4f5f8",align:"center",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#585757",bold:!1,italic:!1,rotate:0,fontSize:10,fontName:"Source Sans Pro"}),X(this,"_freeze",[0,0]),X(this,"_freezeLineStyle",{width:2,color:"#d8d8d8"}),X(this,"_viewport",null);var i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error("target error");this._target=i,this._width=r,this._height=n}var e,r,n;return e=t,n=[{key:"create",value:function(e,r,n){return new t(e,r,n)}}],(r=[{key:"render",value:function(){return this._viewport=new q(this),function(t){var e=t._width,r=t._height,n=t._target,i=t._scale,o=t._viewport,a=t._freeze,s=t._rowHeader,l=t._colHeader;if(o){var u=new b(n,i);u.size(e,r);var c=I(o.areas,4),h=c[0],f=c[1],d=c[2],v=c[3],y=I(o.headerAreas,4),w=y[0],g=y[1],_=y[2],m=y[3];M(u,v,t),M(u,h,t),N(u,w,t),M(u,d,t),D(u,m,t),M(u,f,t),N(u,g,t),D(u,_,t);var k=I(a,2),x=k[0],R=k[1];(x>0||R>0)&&z(u,t._freezeLineStyle,(function(){x>0&&u.line(0,v.y,e,v.y),R>0&&u.line(v.x,0,v.x,r)}));var C=f.x,S=f.y;if(C>0&&S>0){var A=p.create(0,0,0,0,0,0,(function(){return l.height}),(function(){return s.width}));W(u,A,(function(){return""}),void 0,(function(t){return t}),t._headerCellStyle,t._headerLineStyle,t._styles)}}}(this),this}},{key:"width",value:function(t){return this._width=t,this}},{key:"height",value:function(t){return this._height=t,this}},{key:"scale",value:function(t){return this._scale=t,this}},{key:"rows",value:function(t){return this._rows=t,this}},{key:"cols",value:function(t){return this._cols=t,this}},{key:"rowHeight",value:function(t){return this._rowHeight=t,this}},{key:"colWidth",value:function(t){return this._colWidth=t,this}},{key:"startRow",value:function(t){return this._startRow=t,this}},{key:"startCol",value:function(t){return this._startCol=t,this}},{key:"scrollRows",value:function(t){return this._scrollRows=t,this}},{key:"scrollCols",value:function(t){return this._scrollCols=t,this}},{key:"row",value:function(t){return this._row=t,this}},{key:"col",value:function(t){return this._col=t,this}},{key:"cell",value:function(t){return this._cell=t,this}},{key:"cellRenderer",value:function(t){return this._cellRenderer=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"merges",value:function(t){return t&&(this._merges=t),this}},{key:"styles",value:function(t){return t&&(this._styles=t),this}},{key:"borders",value:function(t){return t&&(this._borders=t),this}},{key:"lineStyle",value:function(t){return Object.assign(this._lineStyle,t),this}},{key:"cellStyle",value:function(t){return Object.assign(this._cellStyle,t),this}},{key:"rowHeader",value:function(t){return t&&Object.assign(this._rowHeader,t),this}},{key:"colHeader",value:function(t){return t&&Object.assign(this._colHeader,t),this}},{key:"headerLineStyle",value:function(t){return Object.assign(this._headerLineStyle,t),this}},{key:"headerCellStyle",value:function(t){return t&&Object.assign(this._headerCellStyle,t),this}},{key:"freeze",value:function(t){return t&&(this._freeze=s(t)),this}},{key:"freezeLineStyle",value:function(t){return Object.assign(this._freezeLineStyle,t),this}},{key:"rowHeightAt",value:function(t){var e=this._row;if(e){var r=e(t);if(r)return r.hide?0:r.height}return this._rowHeight}},{key:"colWidthAt",value:function(t){var e=this._col;if(e){var r=e(t);if(r)return r.hide?0:r.width}return this._colWidth}},{key:"viewport",get:function(){return this._viewport}}])&&Y(e.prototype,r),n&&Y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();try{var J;window&&((J=window).wolf||(J.wolf={}),window.wolf.table_renderer=Q.create)}catch(e){}t.exports=r})()},757:(t,e,r)=>{t.exports=r(666)},666:t=>{var e=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var i=e&&e.prototype instanceof w?e:w,o=Object.create(i.prototype),a=new j(n||[]);return o._invoke=function(t,e,r){var n=h;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===v){if("throw"===i)throw o;return T()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=C(a,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var l=c(t,e,r);if("normal"===l.type){if(n=r.done?v:f,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=v,r.method="throw",r.arg=l.arg)}}}(t,r,a),o}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h="suspendedStart",f="suspendedYield",d="executing",v="completed",y={};function w(){}function g(){}function p(){}var _={};l(_,o,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(O([])));b&&b!==r&&n.call(b,o)&&(_=b);var k=p.prototype=w.prototype=Object.create(_);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(i,o,a,s){var l=c(t[i],t,o);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(l.arg)}var i;this._invoke=function(t,n){function o(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(o,o):o()}}function C(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=c(n,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(t){if(t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:T}}function T(){return{value:e,done:!0}}return g.prototype=p,l(k,"constructor",p),l(p,"constructor",g),g.displayName=l(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},x(R.prototype),l(R.prototype,a,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new R(u(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(k),l(k,s,"Generator"),l(k,o,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=O,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:O(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";function t(t,e,r,n,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}function e(t){if(Array.isArray(t))return t}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,r){return e(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(t,r)||o(t,r)||a()}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(n),r.d(n,{default:()=>tt});var f=r(757),d=r.n(f),v=r(402),y=r.n(v),w=function(){function t(){l(this,t),h(this,"_",[]),h(this,"_indexes",new Map),h(this,"_formulas",[]),h(this,"_formulaParser",(function(t){return t})),h(this,"_formatter",(function(t){return t}))}return c(t,[{key:"formulaParser",value:function(t){return this._formulaParser=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"load",value:function(t){var e=t.cells;e&&(this._=e,this.resetIndexes())}},{key:"get",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t).get(e);return void 0!==n?this._[n][2]:null}return null}},{key:"set",value:function(t,e,r){var n=this.get(t,e);if(null==n){var i=this._.push([t,e,r])-1;this.updateIndex(t,e,i),this.addFormula(r,i)}else{var o=r instanceof Object&&n instanceof Object&&r.value!==n.value;Object.assign(n,r),o&&this.resetFormulas()}}},{key:"resetIndexes",value:function(){for(var t=this._,e=0;e<t.length;e+=1){var r=s(t[e],3),n=r[0],i=r[1],o=r[2];this.updateIndex(n,i,e),this.addFormula(o,e)}}},{key:"updateIndex",value:function(t,e,r){var n=this._indexes;n.has(t)||n.set(t,new Map),n.get(t).set(e,r)}},{key:"addFormula",value:function(t,e){t instanceof Object&&t.formula&&(t.value=this._formulaParser(t.formula),this._formulas.push(e))}},{key:"resetFormulas",value:function(){var t=this;this._formulas.forEach((function(e){var r=s(t._[e],3)[2];r instanceof Object&&(r.value=t._formulaParser(r.formula))}))}}]),t}();function g(t){return t instanceof Object?t.value:t}function p(t,e,r,n,i){var o=t.scroll,a="row"===n?0:1,s="row"===n?3:2,l=o[s],u=!1,c=o[a],h=0,f=t.freeze;if(f&&(h=(0,v.expr2xy)(f)["row"===n?1:0]),r>0)if("+"===e)for(var d="row"===n?t.rows.len:t.cols.len,y=c;y<d&&!(l>=r);y+=1)l+=i(h+y),t.scroll[a]=y+1,u=!0;else for(var w=c;w>0&&!(l<=r);w-=1)l-=i(h+w),t.scroll[a]=w-1,u=!0;else t.scroll[a]=0,l=0,u=!0;return o[s]=l,u}function _(t,e){var r=t.merges;if(r)for(var n=v.Range.with(e),i=0;i<r.length;i+=1)if(v.Range.with(r[i]).equals(n))return!0;return!1}function m(t,e){var r=v.Range.with(e);if(r.multiple){t.merges||(t.merges=[]);var n=t.merges;n.length<=0||n.forEach((function(t,e){v.Range.with(t).within(r)&&n.splice(e,1)})),n.push(e)}}function b(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1)if(r[n]===e)return void r.splice(n,1)}function k(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1){var i=v.Range.with(r[n]);i.intersects(e)&&(e=i.union(e))}return e}function x(t,e,r){for(var n=0,i=t;i<e;i+=1)n+=r(i);return n}function R(t,e){var r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(var n=0;n<r.length;n+=1){var i=r[n],o=t[i],a=e[i];if(void 0===a)return!1;if("string"==typeof o||"number"==typeof o||"boolean"==typeof o){if(o!==a)return!1}else if(Array.isArray(o)){if(o.length!==a.length)return!1;for(var s=0;s<o.length;s+=1)if(!R(o[s],a[s]))return!1}else if("function"!=typeof o&&!Array.isArray(o)&&o instanceof Object&&!R(o,a))return!1}return!0}function C(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function S(t){return function(t){if(Array.isArray(t))return i(t)}(t)||C(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t){return e(t)||C(t)||o(t)||a()}function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function O(t,e,r){var n=t.cols[e]||{width:t.colWidth};return r?t.cols[e]=Object.assign(n,r):n}function T(t,e,r){if(!r){var n=O(t,e);return n.hide?0:n.width}var i=t.cols;i[e]?i[e].width=r:i[e]={width:r}}function E(t,e,r){var n=t.cols;if(1===arguments.length){var i=n.len*t.colWidth;for(var o in n)if("len"!==o){var a=T(t,parseInt(o,10));a>0&&(i+=a,i-=t.colWidth)}return i}return x(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return T(t,e)}))}function P(t,e,r){var n=t.rows[e]||{height:t.rowHeight};return r?t.rows[e]=Object.assign(n,r):n}function H(t,e,r){if(!r){var n=P(t,e);return n.hide?0:n.height}var i=t.rows;i[e]?i[e].height=r:i[e]={height:r}}function I(t,e,r){var n=t.rows;if(1===arguments.length){var i=n.len*t.rowHeight;for(var o in n)if("len"!==o){var a=H(t,parseInt(o,10));a>0&&(i+=a,i-=t.rowHeight)}return i}return x(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return H(t,e)}))}function L(){for(var t=document.createDocumentFragment(),e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){var r;r=e instanceof z?e._:"string"==typeof e?document.createTextNode(e):e,t.appendChild(r)})),t}var z=function(){function t(e,r){if(l(this,t),h(this,"_data",new Map),this._=e instanceof Node?e:document.createElement(e),r)if("string"==typeof r)this._.className=r;else if(Array.isArray(r))this._.className=r.join(" ");else for(var n=0,i=Object.entries(r);n<i.length;n++){var o=s(i[n],2),a=o[0];o[1]&&this._.classList.add(a)}}return c(t,[{key:"element",value:function(){return this._}},{key:"data",value:function(t,e){return e?(this._data.set(t,e),this):this._data.get(t)}},{key:"on",value:function(t,e){var r=A(t.split(".")),n=r[0],i=r.slice(1);return this._.addEventListener(n,(function(t){e(t);for(var r=0;r<i.length;r+=1)"stop"===i[r]&&t.stopPropagation(),"prevent"===i[r]&&t.preventDefault()})),this}},{key:"focus",value:function(){return this._.focus(),this}},{key:"value",value:function(t){return void 0!==t?(this._.value=t,this):this._.value}},{key:"textContent",value:function(t){return this._.textContent=t,this}},{key:"html",value:function(t){return this._.innerHTML=t,this}},{key:"attr",value:function(t,e){return e?(this._.setAttribute(t,e),this):this._.getAttribute(t)}},{key:"css",value:function(t,e){var r=this;return e?(this._.style.setProperty(t,e),this):"string"==typeof t?this._.style.getPropertyValue(t):(Object.keys(t).forEach((function(e){var n=t[e];"number"==typeof n&&(n="".concat(n,"px")),r._.style.setProperty(e,n)})),this)}},{key:"rect",value:function(){return this._.getBoundingClientRect()}},{key:"offset",value:function(){var t=this._;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}}},{key:"show",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.css("display",t?"block":"none"),this}},{key:"hide",value:function(){return this.css("display","none"),this}},{key:"scrollx",value:function(t){var e=this._;return void 0!==t?(e.scrollLeft=t,this):e.scrollLeft}},{key:"scrolly",value:function(t){var e=this._;return void 0!==t?(e.scrollTop=t,this):e.scrollTop}},{key:"after",value:function(){return this._.after(L.apply(void 0,arguments)),this}},{key:"before",value:function(){return this._.before(L.apply(void 0,arguments)),this}},{key:"append",value:function(){return this._.append(L.apply(void 0,arguments)),this}},{key:"remove",value:function(){for(var e=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n.forEach((function(r){e._.removeChild(r instanceof t?r._:r)}))}},{key:"cloneNode",value:function(){return this._.cloneNode(!0)}},{key:"firstChild",get:function(){var e=this._.firstChild;return e?new t(e):null}}]),t}();function W(t,e){return new z(t,e)}var M="wolf-table",D={vertical:"height",horizontal:"width"},N=function(){function t(e,r){var n=this;l(this,t),h(this,"_value",0),h(this,"_maxValue",0),h(this,"_lastOffset",0),h(this,"_change",null),this._type=e,this._content=W("div","content"),this._=W("div","".concat(M,"-scrollbar ").concat(e)).append(this._content).on("scroll.stop",(function(t){var r=t.target,i=r.scrollTop,o=r.scrollLeft;if(n._change){var a="vertical"===e?i:o,s=a>n._value?"+":"-";n._change(s,a,t),n._value=a}})),r.append(this._)}return c(t,[{key:"value",get:function(){return this._value}},{key:"change",value:function(t){return this._change=t,this}},{key:"scrollBy",value:function(t,e){if(t){var r=this._value,n=this._maxValue,i=r+t;!0===e&&(i=i>=0&&i<=n?i<Math.abs(t)?0:i:n),this.scroll(i)}return this}},{key:"scroll",value:function(t){var e=this._,r=this._type;return void 0!==t?("vertical"===r?e.scrolly(t):e.scrollx(t),this):"vertical"===r?e.scrolly():e.scrollx()}},{key:"resize",value:function(t,e){if(e>t-1){var r=D[this._type];this._content.css(r,"".concat(e,"px")),this._.css(r,"".concat(t,"px")).show(),this._maxValue=e-t}else this._.hide();return this}}]),t}();function B(t,e,r){t.addEventListener(e,r)}function F(t,e,r){t.removeEventListener(e,r)}var K=function(){function t(e,r,n,i){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};l(this,t),h(this,"_cell",null),this._type=e,this._minValue=n,this._lineLength=i,this._change=a,this._=W("div","".concat(M,"-resizer ").concat(e)).append(this._hover=W("div","hover").on("mousedown.stop",(function(t){return G(o,t)})),this._line=W("div","line")),r.append(this._)}return c(t,[{key:"show",value:function(t){this._cell=t;var e=this._type,r=t.x,n=t.y,i=t.width,o=t.height;this._.css("left","".concat("row"===e?r:r+i-5,"px")).css("top","".concat("row"===e?n+o-5:n,"px")).show();var a="row"===e?"width":"height";this._hover.css(a,"".concat(t[a],"px")),this._line.css(a,"".concat(this._lineLength(),"px"))}},{key:"hide",value:function(){this._.hide()}}]),t}();function G(t,e){var r=t._type,n=t._cell,i=t._minValue,o=t._,a=t._line,s=t._change,l=0;a.show();var u=function(t){null!==e&&1===t.buttons&&n&&("row"===r?(l+=t.movementY)+n.height>=i?o.css("top","".concat(n.y+n.height+l,"px")):l=i-n.height:(l+=t.movementX)+n.width>=i?o.css("left","".concat(n.x+n.width+l,"px")):l=i-n.width)};B(window,"mousemove",u),B(window,"mouseup",(function t(){F(window,"mousemove",u),F(window,"mouseup",t),a.hide(),o.hide(),n&&0!=l&&s(l,n)}))}var U=function(){function t(e){l(this,t),h(this,"oldRanges",[]),h(this,"ranges",[]),h(this,"rowHeaderRanges",[]),h(this,"colHeaderRanges",[]),h(this,"focus",[0,0]),h(this,"focusRange",null),h(this,"focusRect",null),h(this,"focusTarget",null),h(this,"_placement","body"),h(this,"_areas",[]),h(this,"_rowHeaderAreas",[]),h(this,"_colHeaderAreas",[]),h(this,"_",null),h(this,"_targets",[]),h(this,"_targetChildren",[]),this._corner=W("div","corner"),this._data=e}return c(t,[{key:"placement",value:function(t){return void 0===t?this._placement:(this._placement=t,this)}},{key:"addRange",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.focus=[t,e];var n=k(this._data,v.Range.create(t,e));return r&&this.clearRanges(),this.ranges.push(n),this.focusRange=n,$(this),this}},{key:"unionRange",value:function(t,e){var r=v.Range.create(t,e),n=this.ranges,i=this.focusRange;if(i){var o=i.union(r);n.splice(-1,1,k(this._data,o)),$(this)}return this}},{key:"clearRanges",value:function(){return this.oldRanges=this.ranges,this.ranges=[],this}},{key:"move",value:function(t,e){var r=this.focusRange;if(r&&e>0){var n=r.startRow,i=r.startCol,o=r.endRow,a=r.endCol,l=this._data,u=l.rows,c=l.cols,h=function(t,e){for(;;){var r=P(l,t);if(!r||!r.hide)return t;t+=e}},f=function(t,e){for(;;){var r=O(l,t);if(!r||!r.hide)return t;t+=e}},d=s(this.focus,2),v=d[0],y=d[1];"up"===t?v=h(n-e,-1):"down"===t?v=h(o+e,1):"left"===t?y=f(i-e,-1):"right"===t&&(y=f(a+e,1)),v>=0&&v<=u.len-1&&y>=0&&y<=c.len-1&&this.addRange(v,y,!0)}}},{key:"setFocusRectAndTarget",value:function(t,e){this.focusRect=t,this.focusTarget=e}},{key:"addAreaRect",value:function(t,e){var r=e.x,n=e.y,i=e.width,o=e.height;return this._areas.push(W("div","".concat(M,"-selector-area")).css({left:r+2,top:n+2,width:i-4,height:o-4}).show()),t===this.ranges.length-1&&(this._=W("div","".concat(M,"-selector")).css({left:r-1,top:n-1,width:i-2,height:o-2}).show(),"body"===this._placement&&this._.append(this._corner)),this}},{key:"addRowHeaderAreaRect",value:function(t){var e=t.x,r=t.y,n=t.width,i=t.height;return this._rowHeaderAreas.push(W("div","".concat(M,"-selector-area row-header")).css({left:e,top:r,width:n,height:i}).show()),this}},{key:"addColHeaderAreaRect",value:function(t){var e=t.x,r=t.y,n=t.width,i=t.height;return this._colHeaderAreas.push(W("div","".concat(M,"-selector-area col-header")).css({left:e,top:r,width:n,height:i}).show()),this}},{key:"addTarget",value:function(t){var e;return e=[].concat(S(this._areas),S(this._rowHeaderAreas),S(this._colHeaderAreas)),this._areas.length>0&&this._&&e.push(this._),t.append.apply(t,S(e)),this._targetChildren.push(e),this._targets.push(t),this.clearAreas(),this}},{key:"clearTargets",value:function(){var t=this;return this.focusTarget=null,this._targets&&this._targets.length>0&&(this._targets.forEach((function(e,r){return e.remove.apply(e,S(t._targetChildren[r]))})),[this._targetChildren,this._targets].forEach((function(t){return t.length=0})),this.clearAreas()),this}},{key:"clearAreas",value:function(){[this._rowHeaderAreas,this._colHeaderAreas,this._areas].forEach((function(t){return t.length=0})),this._=null}}]),t}();function V(t,e,r){t.sort(e);var n=t[0],i=[];1===t.length&&i.push(n);for(var o=1;o<t.length;o+=1){var a=t[o];r(n,a)?n=n.union(a):(i.push(n),n=a)}return t.length>1&&i.push(n),i}function $(t){for(var e=[],r=[],n=0;n<t.ranges.length;n+=1){var i=t.ranges[n],o=i.startRow,a=i.startCol,s=i.endRow,l=i.endCol;(o>0||s>0)&&e.push(v.Range.create(o,0,s,0)),(a>0||l>0)&&r.push(v.Range.create(0,a,0,l))}t.rowHeaderRanges=V(e,(function(t,e){return t.startRow-e.startRow}),(function(t,e){return t.intersectsRow(e.startRow,e.endRow)})),t.colHeaderRanges=V(r,(function(t,e){return t.startCol-e.startCol}),(function(t,e){return t.intersectsCol(e.startCol,e.endCol)}))}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Y(){return W("div","".concat(M,"-overlayer-area"))}var X=function(){function t(e){l(this,t),h(this,"areaRects",[]),this.areas=[Y(),Y(),Y(),Y()],this.headerAreas=[Y(),Y(),Y(),Y()],e.append.apply(e,S(this.areas).concat(S(this.headerAreas)))}return c(t,[{key:"area",value:function(t,e){if(e){this.areaRects[t]=e;var r=e.x,n=e.y,i=e.height,o=e.width;return this.areas[t].css({left:r,top:n,width:o,height:i}),this}return this.areas[t]}},{key:"headerArea",value:function(t,e){if(e){var r=e.x,n=e.y,i=e.height,o=e.width;this.headerAreas[t].css({left:r,top:n,width:o,height:i})}return this.headerAreas[t]}},{key:"inAreas",value:function(t){var e,r=t.x,n=t.y,i=t.height,o=r+t.width,a=n+i,s=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(this.areaRects);try{for(s.s();!(e=s.n()).done;){var l=e.value;if(r>=0&&o<=l.width&&n>=0&&a<=l.height)return!0}}catch(t){s.e(t)}finally{s.f()}return!1}}]),t}(),Q=function(){function t(e,r,n,i,o){var a=this;l(this,t),h(this,"_",W("div","".concat(M,"-editor"))),h(this,"_text",W("textarea","")),h(this,"_textMeasure",W("div","measure")),h(this,"_rect",null),h(this,"_value",""),h(this,"_editing",!1),h(this,"_visible",!1),h(this,"_inputChange",(function(){})),h(this,"_moveChange",(function(){})),this._maxHeight=n,this._maxWidth=r,this._fontFamily=o,this._fontSize=i,e.append(this._),this._.append(this._text,this._textMeasure),this._text.on("keydown",(function(t){!function(t,e){var r=e.code,n=e.shiftKey,i=e.metaKey,o=e.altKey,a=e.ctrlKey,s=e.target,l=function(e){t._moveChange(e,t._value),t.hide()};"Enter"===r?(a||i||o?(s.value+="\n",t.value(s.value)):l(n?"up":"down"),e.preventDefault()):"Tab"!==r||a||i||o||(l(n?"left":"right"),e.preventDefault())}(a,t)})).on("input",(function(t){var e=t.target,r=e.value;a._editing=!0,a._value=r,a._inputChange(e.value),J(a)}))}return c(t,[{key:"visible",get:function(){return this._visible}},{key:"appendTo",value:function(t){return t.append(this._),this}},{key:"value",value:function(t){if(void 0===t)return this._value;this._value=t,this._text.value(t),J(this)}},{key:"finished",value:function(){this._editing&&this._moveChange("none",this._value),this.hide()}},{key:"show",value:function(t){var e=this;if(t){this._visible=!0,this._rect=t;var r=t.x,n=t.y,i=t.width,o=t.height;this._.css({left:r-1,top:n-1,width:i-2,height:o-2}).show(),setTimeout((function(){var t=e._value.length,r=e._text.element();r.focus(),r.setSelectionRange(t,t)}),0)}}},{key:"hide",value:function(){this._editing=!1,this._visible=!1,this.value(""),this._.hide()}},{key:"inputChange",value:function(t){this._inputChange=t}},{key:"moveChange",value:function(t){this._moveChange=t}}]),t}();function J(t){var e=t._value,r=t._rect,n=t._maxWidth,i=t._maxHeight,o=t._textMeasure,a=(e.split("\n"),e.replace("\n","<br/>"));if(e.endsWith("\n")&&(a+="T"),o.html(a),r){var s=n()-r.x,l=i()-r.y;o.css("maxWidth","".concat(s,"px"));var u=o.rect(),c=u.width,h=u.height;c>r.width-2&&c<s&&t._.css({width:c}),h>r.height&&h<l?t._.css({height:h}):h<r.height&&t._.css({height:r.height-2})}}var Z,tt=function(){function e(r,n,i,o){l(this,e),h(this,"_colHeader",{height:25,rows:1,cell:function(t,e){return(0,v.stringAt)(e)}}),h(this,"_rowHeader",{width:60,cols:1,cell:function(t,e){return t+1}}),h(this,"_minRowHeight",25),h(this,"_minColWidth",60),h(this,"_contentRect",{x:0,y:0,width:0,height:0}),h(this,"_cells",new w),h(this,"_vScrollbar",null),h(this,"_hScrollbar",null),h(this,"_rowResizer",null),h(this,"_colResizer",null),h(this,"_editor",null),h(this,"_selector",null),this._width=n,this._height=i;var a="string"==typeof r?document.querySelector(r):r;if(null===a)throw new Error("first argument error");if(this._container=W(a,"".concat(M,"-container")).css({height:i(),width:n()}),this._data={rows:{len:100},cols:{len:26},rowHeight:25,colWidth:100,scroll:[0,0,0,0],style:{fontName:"Helvetica",fontSize:10,color:"#333",bgcolor:"#fff",align:"left",valign:"middle",textwrap:!1,bold:!1,italic:!1,underline:!1,strikethrough:!1}},o){var s=o.cols,u=o.rows,c=o.rowHeight,f=o.colWidth,g=o.minRowHeight,_=o.minColWidth,m=o.cellStyle,b=o.rowHeader,k=o.colHeader,x=this._data;g&&(this._minRowHeight=g),_&&(this._minColWidth=_),s&&(x.cols.len=s),u&&(x.rows.len=u),c&&(x.rowHeight=c),f&&(x.colWidth=f),m&&Object.assign(x.style,m),b&&Object.assign(this._rowHeader,b),k&&Object.assign(this._colHeader,k)}et(this);var R,C=document.createElement("canvas"),S=W(C).attr("tabIndex","1");this._container.append(C),this._renderer=new(y())(C,n(),i()),this._overlayer=new X(this._container),null!=o&&o.scrollable&&((R=this)._vScrollbar=new N("vertical",R._container).change((function(t,e){(function(t,e,r){return e&&void 0!==r?p(t,e,r,"row",(function(e){return P(t,e).height})):t.scroll[3]})(R._data,t,e)&&(R.render(),rt(R),it(R))})),R._hScrollbar=new N("horizontal",R._container).change((function(t,e){(function(t,e,r){return e&&void 0!==r?p(t,e,r,"col",(function(e){return O(t,e).width})):t.scroll[2]})(R._data,t,e)&&(R.render(),rt(R),it(R))}))),null!=o&&o.resizable&&function(t){t._rowResizer=new K("row",t._container,t._minRowHeight,(function(){return t._width()}),(function(e,r){var n=r.row,i=r.height;t.rowHeight(n,i+e).render(),rt(t),t._canvas.focus()})),t._colResizer=new K("col",t._container,t._minColWidth,(function(){return t._height()}),(function(e,r){var n=r.col,i=r.width;t.colWidth(n,i+e).render(),rt(t),t._canvas.focus()}))}(this),null!=o&&o.selectable&&(this._selector=new U(this._data)),null!=o&&o.editable&&function(t){t._editor=new Q(t._container,t._width,t._height,"13px","Arial");var e=t._editor,r=t._selector;e.inputChange((function(t){})),e.moveChange((function(e,n){"none"!==e&&r&&(nt(t,e),t._canvas.focus()),function(t,e){var r=t._selector;if(r){var n=r.oldRanges,i=r.ranges;(n.length>0?n:i).forEach((function(r){r.each((function(r,n){t.cell(r,n,{value:e})}))})),t.render()}}(t,n)}))}(this),this._canvas=S,function(t,e){e.on("wheel.prevent",(function(e){var r=e.deltaX,n=e.deltaY,i=t._hScrollbar,o=t._vScrollbar;Math.abs(r)>Math.abs(n)?i&&i.scrollBy(r):o&&o.scrollBy(n)}))}(this,S),function(t,e){e.on("mousemove",(function(e){var r=t._rowResizer,n=t._colResizer,i=t._renderer.viewport,o=e.buttons,a=e.offsetX,s=e.offsetY;if(i&&0===o){var l=t._rowHeader,u=t._colHeader;if(r&&l.width>0)if(a<l.width&&s>u.height){var c=i.cellAt(a,s);c&&r.show(c)}else r.hide();if(n&&u.height>0)if(s<u.height&&a>l.width){var h=i.cellAt(a,s);h&&n.show(h)}else n.hide()}}))}(this,S),function(t,e){e.on("mousedown",(function(r){var n=t._selector,i=t._renderer,o=t._editor,a=i.viewport,s={row:0,col:0};if(n&&a){var l=r.offsetX,u=r.offsetY,c=r.ctrlKey,h=r.metaKey,f=r.shiftKey,d=a.cellAt(l,u);if(d){var v=d.placement,y=d.row,w=d.col;if(f?n.unionRange(y,w):(s={row:y,col:w},n.placement(v).addRange(y,w,!(h||c))),rt(t),"all"!==v){var g=e.rect(),p=g.left,_=g.top,m=function(e){var r=0,i=0;e.x>0&&(r=e.x-p),e.y>0&&(i=e.y-_),"row-header"===v&&(r=1),"col-header"===v&&(i=1);var o=a.cellAt(r,i);if(o){var l=o.row,u=o.col;l==s.row&&u===s.col||(n.unionRange(l,u),rt(t),s={row:l,col:u})}};B(window,"mousemove",m),B(window,"mouseup",(function t(){F(window,"mousemove",m),F(window,"mouseup",t)}))}}}o&&o.finished()}))}(this,S),function(t,e){e.on("dblclick.prevent",(function(){ot(t)}))}(this,S),function(e,r){r.on("keydown.prevent",function(){var r,n=(r=d().mark((function t(r){var n,i,o,a,s,l,u;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.ctrlKey,i=r.shiftKey,o=r.metaKey,a=r.altKey,s=r.code,console.log("code:",s,r),l=null,"Enter"!==s||n||o||a){t.next=7;break}l=i?"up":"down",t.next=29;break;case 7:if("Tab"!==s||n||o||a){t.next=11;break}l=i?"left":"right",t.next=29;break;case 11:if(!s.startsWith("Arrow")){t.next=15;break}l=s.substring(5).toLowerCase(),t.next=29;break;case 15:if(n||o||a||!(s.startsWith("Key")||s.startsWith("Digit")||["Minus","Equal","Space","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"].includes(s))){t.next=19;break}ot(e),t.next=29;break;case 19:if("KeyC"!==s||!n&&!o){t.next=23;break}console.log("copy"),t.next=29;break;case 23:if("KeyV"!==s||!n&&!o){t.next=29;break}return t.next=26,navigator.clipboard.readText();case 26:u=t.sent,console.log("Pasted text: ",u),console.log("paste");case 29:l&&nt(e,l);case 30:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=r.apply(e,n);function s(e){t(a,i,o,s,l,"next",e)}function l(e){t(a,i,o,s,l,"throw",e)}s(void 0)}))});return function(t){return n.apply(this,arguments)}}())}(this,S)}return c(e,[{key:"data",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return t?(Object.assign(this._data,t),this._cells.load(this._data),et(this),this):this._data}))},{key:"contentRect",value:function(){return this._contentRect}},{key:"resize",value:function(){this._container.css({height:this._height(),width:this._width()}),this.render()}},{key:"freeze",value:function(t){return t&&(this._data.freeze=t),this}},{key:"isMerged",value:function(t){var e=this;if(t)return _(this._data,t);var r=this._selector;return!!r&&r.ranges.every((function(t){return _(e._data,t.toString())}))}},{key:"merge",value:function(t){var e=this;if(t)m(this._data,t);else{var r=this._selector;r&&r.ranges.forEach((function(t){return m(e._data,t.toString())}))}return this}},{key:"unmerge",value:function(t){var e=this;if(t)b(this._data,t);else{var r=this._selector;r&&r.ranges.forEach((function(t){return b(e._data,t.toString())}))}return this}},{key:"row",value:function(t,e){return e?(e.height&&this.rowHeight(t,e.height),P(this._data,t,e),this):P(this._data,t)}},{key:"rowHeight",value:function(t,e){var r=H(this._data,t);return e?(r!==e&&(H(this._data,t,e),this._contentRect.height+=e-r),this):r}},{key:"col",value:function(t,e){return e?(e.width&&this.colWidth(t,e.width),O(this._data,t,e),this):O(this._data,t)}},{key:"colWidth",value:function(t,e){var r=T(this._data,t);return e?(r!==e&&(T(this._data,t,e),this._contentRect.width+=e-r),this):r}},{key:"colsWidth",value:function(t,e){return E(this._data,t,e)}},{key:"rowsHeight",value:function(t,e){return I(this._data,t,e)}},{key:"formulaParser",value:function(t){return this._cells.formulaParser(t),this}},{key:"formatter",value:function(t){return this._cells.formatter(t),this}},{key:"addStyle",value:function(t){return function(t,e){if(t.styles||(t.styles=[]),e)for(var r=0;r<t.styles.length;r+=1)if(R(t.styles[r],e))return r;return t.styles.push(e)-1}(this._data,t)}},{key:"clearStyles",value:function(){var t;return(t=this._data).styles&&delete t.styles,this}},{key:"addBorder",value:function(t){return function(t,e){t.borders||(t.borders=[]);for(var r=v.Range.with(e[0]),n=t.borders,i=function(t){var i=A(n[t]),o=i[0],a=i.slice(1),s=v.Range.with(o);if(s.intersects(r))return s.within(r)||(n.push(e),s.difference(r).forEach((function(t){n.push([t.toString()].concat(S(a)))}))),n.splice(t,1),{v:void 0}},o=0;o<n.length;o+=1){var a=i(o);if("object"===j(a))return a.v}n.push(e)}(this._data,t),this}},{key:"clearBorder",value:function(t){var e,r,n;return e=this._data,r=t,(n=e.borders)&&function(){for(var t=[],e=v.Range.with(r),i=function(r){var i=A(n[r]),a=i[0],s=i.slice(1),l=v.Range.with(a);l.intersects(e)&&(l.within(e)||l.difference(e).forEach((function(e){t.push([e.toString()].concat(S(s)))})),n.splice(r,1),r-=1),o=r},o=0;o<n.length;o+=1)i(o);n.push.apply(n,t)}(),this}},{key:"clearBorders",value:function(){var t;return(t=this._data).borders&&delete t.borders,this}},{key:"cell",value:function(t,e,r){var n=this._cells;return r?(n.set(t,e,r),this):n.get(t,e)}},{key:"cellValue",value:function(t,e){return g(this.cell(t,e))}},{key:"render",value:function(){var t=this;this._renderer.colHeader(this._colHeader).rowHeader(this._rowHeader).scrollRows(this._data.scroll[0]).scrollCols(this._data.scroll[1]).merges(this._data.merges).freeze(this._data.freeze).styles(this._data.styles).borders(this._data.borders).rows(this._data.rows.len).cols(this._data.cols.len).row((function(e){return P(t._data,e)})).col((function(e){return O(t._data,e)})).cell((function(e,r){return t.cell(e,r)})).formatter(this._cells._formatter).render();var e,r,n,i,o,a,s=this._renderer,l=this._overlayer,u=s.viewport;return u&&(u.areas.forEach((function(t,e){l.area(e,t)})),u.headerAreas.forEach((function(t,e){l.headerArea(e,t)})),r=(e=this)._contentRect,n=r.x,i=r.y,o=r.height,a=r.width,e._vScrollbar&&e._vScrollbar.resize(e._height(),o+i),e._hScrollbar&&e._hScrollbar.resize(e._width(),a+n)),this}}],[{key:"create",value:function(t,r,n,i){return new e(t,r,n,i)}}]),e}();function et(t){t._contentRect={x:t._rowHeader.width,y:t._colHeader.height,width:E(t._data),height:I(t._data)}}function rt(t){var e=t._selector,r=t._overlayer,n=t._container,i=t._rowHeader,o=t._colHeader,a=t._renderer.viewport;if(e&&a){var s=e._placement;e.clearTargets();var l=i.width,u=o.height,c=t._width()-l,h=t._height()-u,f=function(t,n){a.areas.forEach((function(i,o){var a=!1,s=r.areas[o];e.ranges.forEach((function(r,s){t(i.range,r)&&(a=!0,e.addAreaRect(s,n(i,r,o)))}));var l=e.focusRange;l&&t(i.range,l)&&e.setFocusRectAndTarget(n(i,l,o),s),a&&e.addTarget(s)}))},d=function(t,n){n.forEach((function(n){var i=a.headerAreas[n],o=!1;("row"===t?e.rowHeaderRanges:e.colHeaderRanges).forEach((function(r){"row"===t?i.range.intersectsRow(r.startRow,r.endRow)&&(o=!0,e.addRowHeaderAreaRect(i.rectRow(r.startRow,r.endRow))):i.range.intersectsCol(r.startCol,r.endCol)&&(o=!0,e.addColHeaderAreaRect(i.rectCol(r.startCol,r.endCol)))})),o&&e.addTarget(r.headerAreas[n])}))};"all"===s?e.addAreaRect(0,{x:l,y:u,width:c,height:h}).addRowHeaderAreaRect({x:0,y:u,width:l,height:h}).addColHeaderAreaRect({x:l,y:0,width:c,height:u}).addTarget(n):"row-header"===s?(f((function(t,e){return t.intersectsRow(e.startRow,e.endRow)}),(function(t,e,r){var n=t.rectRow(e.startRow,e.endRow);return n.width+=2,0!==r&&3!==r||(n.x-=2),n})),d("row",[2,3]),[0,1].forEach((function(t){e.addColHeaderAreaRect({x:0,y:0,width:c,height:u}).addTarget(r.headerAreas[t])}))):"col-header"===s?(f((function(t,e){return t.intersectsCol(e.startCol,e.endCol)}),(function(t,e,r){var n=t.rectCol(e.startCol,e.endCol);return n.height+=2,2!==r&&3!==r||(n.y-=2),n})),d("col",[0,1]),[2,3].forEach((function(t){e.addRowHeaderAreaRect({x:0,y:0,height:h,width:l}).addTarget(r.headerAreas[t])}))):(f((function(t,e){return t.intersects(e)}),(function(t,e){return t.rect(e)})),d("row",[2,3]),d("col",[0,1]))}}function nt(t,e){var r=t._selector,n=t._data,i=t._renderer.viewport;if(r&&i){var o=s(r.focus,2),a=o[0],l=o[1];if(r.move(e,1),n.freeze&&("down"===e||"right"===e)){var u,c,h=s((0,v.expr2xy)(n.freeze),2),f=h[0],d=h[1],y=s(n.scroll,2),w=y[0],g=y[1];if(a+1===d&&w>0)return void(null===(u=t._vScrollbar)||void 0===u||u.scroll(0));if(l+1===f&&g>0)return void(null===(c=t._hScrollbar)||void 0===c||c.scroll(0))}var p=s(i.areas,4)[3],_=s(r.focus,2);a=_[0],l=_[1];var m=r.focusRange,b=1,k=1;m&&(b+=m.rows,k+=m.cols);var x,R=p.range,C=R.startRow,S=R.startCol,A=R.endRow,j=R.endCol;if(i.inAreas(a,l)&&A!==a&&j!==l)rt(t);else if("up"===e)null===(x=t._vScrollbar)||void 0===x||x.scrollBy(-t.rowsHeight(a,a+b),!0);else if("down"===e){var O;null===(O=t._vScrollbar)||void 0===O||O.scrollBy(t.rowsHeight(C,C+b),!0)}else if("left"===e){var T;null===(T=t._hScrollbar)||void 0===T||T.scrollBy(-t.colsWidth(l,l+k),!0)}else if("right"===e){var E;null===(E=t._hScrollbar)||void 0===E||E.scrollBy(t.colsWidth(S,S+k),!0)}}}function it(t){var e=t._editor,r=t._selector;if(e&&r&&e.visible&&"body"===r._placement){var n=r.focusRect,i=r.focusTarget;n&&i?e.appendTo(i).show(n):e.show({x:-100,y:-100,width:0,height:0})}}function ot(t){var e,r=t._selector,n=t._editor;if(r&&n&&"body"===r._placement){var i=r.focusRange,o=r.focusRect,a=r.focusTarget;if(i&&o&&a){n.appendTo(a).show(o);var s=t.cell(i.startRow,i.startCol);s&&n.value((e=g(s),"".concat(null!=e?e:"")))}}}window&&((Z=window).wolf||(Z.wolf={}),window.wolf.table=tt.create)})(),module.exports=n})();